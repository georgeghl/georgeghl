
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../OtherSystem/">
      
      
        <link rel="next" href="../k8s/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.18">
    
    
      
        <title>Docker - 个人笔记教程</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.66ac8b77.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#docker" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="个人笔记教程" class="md-header__button md-logo" aria-label="个人笔记教程" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            个人笔记教程
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Docker
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="个人笔记教程" class="md-nav__button md-logo" aria-label="个人笔记教程" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    个人笔记教程
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    资源查找
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            资源查找
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mirrors.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    点击进入
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CMGOS.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    神州网信政府版
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    操作系统
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            操作系统
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Android/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Andorid
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Ubuntu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ubuntu
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Windows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Windows
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Openwrt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Openwrt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CQU_openwrt%E6%95%99%E7%A8%8B/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CQU_openwrt教程
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OtherSystem/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OtherSystem
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    软件
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            软件
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" checked>
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    开发工具/容器
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            开发工具/容器
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Docker
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Docker
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#docker" class="md-nav__link">
    <span class="md-ellipsis">
      docker安装
    </span>
  </a>
  
    <nav class="md-nav" aria-label="docker安装">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#for-ubuntu" class="md-nav__link">
    <span class="md-ellipsis">
      官方教程 for Ubuntu
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tsinghua" class="md-nav__link">
    <span class="md-ellipsis">
      使用Tsinghua源
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      使用阿里源(推荐使用)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ustc" class="md-nav__link">
    <span class="md-ellipsis">
      使用ustc源
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sjtu" class="md-nav__link">
    <span class="md-ellipsis">
      使用sjtu源
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#docker-compose" class="md-nav__link">
    <span class="md-ellipsis">
      docker-compose安装
    </span>
  </a>
  
    <nav class="md-nav" aria-label="docker-compose安装">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#apt" class="md-nav__link">
    <span class="md-ellipsis">
      apt安装
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#docker_1" class="md-nav__link">
    <span class="md-ellipsis">
      docker国内镜像
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#docker_2" class="md-nav__link">
    <span class="md-ellipsis">
      docker走代理
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wsldocker" class="md-nav__link">
    <span class="md-ellipsis">
      WSL设置docker代理
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#portainerdocker" class="md-nav__link">
    <span class="md-ellipsis">
      Portainer(docker面板)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#grafana" class="md-nav__link">
    <span class="md-ellipsis">
      Grafana
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#uptime-kuma" class="md-nav__link">
    <span class="md-ellipsis">
      uptime-kuma(应用监控)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#minio" class="md-nav__link">
    <span class="md-ellipsis">
      minio(分布式对象存储服务器)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sun-panel" class="md-nav__link">
    <span class="md-ellipsis">
      sun-panel
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1panellinux" class="md-nav__link">
    <span class="md-ellipsis">
      1panel(Linux运维面板)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code-server" class="md-nav__link">
    <span class="md-ellipsis">
      code-server
    </span>
  </a>
  
    <nav class="md-nav" aria-label="code-server">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#coderconcode-server" class="md-nav__link">
    <span class="md-ellipsis">
      codercon/code-server
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linuxservercode-server" class="md-nav__link">
    <span class="md-ellipsis">
      linuxserver/code-server
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mysql8" class="md-nav__link">
    <span class="md-ellipsis">
      mysql8部署
    </span>
  </a>
  
    <nav class="md-nav" aria-label="mysql8部署">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      部署命令
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      配置命令
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mysql57" class="md-nav__link">
    <span class="md-ellipsis">
      mysql5.7部署
    </span>
  </a>
  
    <nav class="md-nav" aria-label="mysql5.7部署">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      部署命令
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      配置命令
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mongodb" class="md-nav__link">
    <span class="md-ellipsis">
      mongodb部署
    </span>
  </a>
  
    <nav class="md-nav" aria-label="mongodb部署">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      部署命令
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#apache2" class="md-nav__link">
    <span class="md-ellipsis">
      apache2部署
    </span>
  </a>
  
    <nav class="md-nav" aria-label="apache2部署">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      部署命令
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      配置命令
    </span>
  </a>
  
    <nav class="md-nav" aria-label="配置命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      修改中文显示
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      设置需要密码访问
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#404" class="md-nav__link">
    <span class="md-ellipsis">
      自定义404等页面
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#navidrome" class="md-nav__link">
    <span class="md-ellipsis">
      navidrome自建音乐播放器
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jellyfin" class="md-nav__link">
    <span class="md-ellipsis">
      jellyfin
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kodexplorer" class="md-nav__link">
    <span class="md-ellipsis">
      kodexplorer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="kodexplorer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      1.快速启动
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      2.实现数据持久化——创建数据目录并在启动时挂载
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      3.禁止更新：
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nextcloud" class="md-nav__link">
    <span class="md-ellipsis">
      nextcloud部署
    </span>
  </a>
  
    <nav class="md-nav" aria-label="nextcloud部署">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      部署命令
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nextcloud-0770" class="md-nav__link">
    <span class="md-ellipsis">
      错误：nextcloud 您的数据目录可被其他用户读取 请更改权限为 0770 以避免其他用户查看目录
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nextcloud-ipip" class="md-nav__link">
    <span class="md-ellipsis">
      Nextcloud 通过不被信任的域名访问 动态IP解决方案，允许所有IP访问
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#onlyoffice" class="md-nav__link">
    <span class="md-ellipsis">
      onlyoffice部署
    </span>
  </a>
  
    <nav class="md-nav" aria-label="onlyoffice部署">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      部署命令
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      配置命令
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nextcloudonlyoffice" class="md-nav__link">
    <span class="md-ellipsis">
      nextcloud与onlyoffice链接
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jupyterbase-notebook" class="md-nav__link">
    <span class="md-ellipsis">
      jupyter/base-notebook配置
    </span>
  </a>
  
    <nav class="md-nav" aria-label="jupyter/base-notebook配置">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      镜像拉取
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      创建容器
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      修改中文
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rtmp" class="md-nav__link">
    <span class="md-ellipsis">
      rtmp
    </span>
  </a>
  
    <nav class="md-nav" aria-label="rtmp">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#to-stream-to-the-server" class="md-nav__link">
    <span class="md-ellipsis">
      To stream to the server
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calibre-web" class="md-nav__link">
    <span class="md-ellipsis">
      calibre-web部署
    </span>
  </a>
  
    <nav class="md-nav" aria-label="calibre-web部署">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#user-group-identifiers" class="md-nav__link">
    <span class="md-ellipsis">
      User / Group Identifiers
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#teamspeak" class="md-nav__link">
    <span class="md-ellipsis">
      teamspeak部署
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kmswindoowsoffice" class="md-nav__link">
    <span class="md-ellipsis">
      kms服务器部署及windoows+office激活
    </span>
  </a>
  
    <nav class="md-nav" aria-label="kms服务器部署及windoows+office激活">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      服务器部署
    </span>
  </a>
  
    <nav class="md-nav" aria-label="服务器部署">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#amogekovlmcsd" class="md-nav__link">
    <span class="md-ellipsis">
      镜像A：mogeko/vlmcsd
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bluodaoyikms-server" class="md-nav__link">
    <span class="md-ellipsis">
      镜像B：luodaoyi/kms-server
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#docker-compose-sparkhadoop" class="md-nav__link">
    <span class="md-ellipsis">
      docker-compose spark+hadoop部署
    </span>
  </a>
  
    <nav class="md-nav" aria-label="docker-compose spark+hadoop部署">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    <span class="md-ellipsis">
      部署命令
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#docker-composesparkhadoop" class="md-nav__link">
    <span class="md-ellipsis">
      docker-compose搭建spark+hadoop集群
    </span>
  </a>
  
    <nav class="md-nav" aria-label="docker-compose搭建spark+hadoop集群">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1dockerdocker-compose" class="md-nav__link">
    <span class="md-ellipsis">
      1、安装docker和docker-Compose
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1、安装docker和docker-Compose">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11docker" class="md-nav__link">
    <span class="md-ellipsis">
      1.1、安装docker
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12docker-compose" class="md-nav__link">
    <span class="md-ellipsis">
      1.2、安装docker-Compose
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2sparkhdfs" class="md-nav__link">
    <span class="md-ellipsis">
      2、极速搭建Spark集群（含HDFS集群）
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2、极速搭建Spark集群（含HDFS集群）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21hadoopenv" class="md-nav__link">
    <span class="md-ellipsis">
      2.1、编辑hadoop.env配置文件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22docker-composeyml" class="md-nav__link">
    <span class="md-ellipsis">
      2.2、编辑docker-compose.yml编排配置文件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13datanode6workeryml" class="md-nav__link">
    <span class="md-ellipsis">
      1、此为（3datanode+6worker）的yml文件示例
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22datanode3workeryml" class="md-nav__link">
    <span class="md-ellipsis">
      2、此为（2datanode+3worker）的yml文件示例
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23docker-compose" class="md-nav__link">
    <span class="md-ellipsis">
      2.3、执行docker-compose命令，一键搭建集群
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24" class="md-nav__link">
    <span class="md-ellipsis">
      2.4、查看集群环境
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3spark" class="md-nav__link">
    <span class="md-ellipsis">
      3、spark集群开机自启动
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3、spark集群开机自启动">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31" class="md-nav__link">
    <span class="md-ellipsis">
      3.1、自定义系统服务
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32" class="md-nav__link">
    <span class="md-ellipsis">
      3.2、设置服务为随系统自启
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#v2ray-core" class="md-nav__link">
    <span class="md-ellipsis">
      v2ray-core
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nginx-proxy-manager" class="md-nav__link">
    <span class="md-ellipsis">
      nginx-proxy-manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openvpn" class="md-nav__link">
    <span class="md-ellipsis">
      openvpn
    </span>
  </a>
  
    <nav class="md-nav" aria-label="openvpn">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_1" class="md-nav__link">
    <span class="md-ellipsis">
      教程1：
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_1" class="md-nav__link">
    <span class="md-ellipsis">
      教程2：
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openvpn-as" class="md-nav__link">
    <span class="md-ellipsis">
      ××openvpn-as
    </span>
  </a>
  
    <nav class="md-nav" aria-label="××openvpn-as">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zh-cn" class="md-nav__link">
    <span class="md-ellipsis">
      zh-cn:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#en" class="md-nav__link">
    <span class="md-ellipsis">
      en:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qbittorrent" class="md-nav__link">
    <span class="md-ellipsis">
      qbittorrent
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../k8s/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    k8s
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Git/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Git
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Maven/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Maven
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Python/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Java/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Java
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Frontend/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    前端
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Backend/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    后端
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    应用软件
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            应用软件
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Acrobat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Acrobat
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chrome/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chrome
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ffmpeg/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ffmpeg
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OfficeWPS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OfficeWPS
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    其他
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            其他
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Printer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Printer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OtherApplication/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OtherApplication
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Maintenance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Maintenance
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../VR/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VR
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Photography/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Photography
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#docker" class="md-nav__link">
    <span class="md-ellipsis">
      docker安装
    </span>
  </a>
  
    <nav class="md-nav" aria-label="docker安装">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#for-ubuntu" class="md-nav__link">
    <span class="md-ellipsis">
      官方教程 for Ubuntu
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tsinghua" class="md-nav__link">
    <span class="md-ellipsis">
      使用Tsinghua源
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      使用阿里源(推荐使用)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ustc" class="md-nav__link">
    <span class="md-ellipsis">
      使用ustc源
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sjtu" class="md-nav__link">
    <span class="md-ellipsis">
      使用sjtu源
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#docker-compose" class="md-nav__link">
    <span class="md-ellipsis">
      docker-compose安装
    </span>
  </a>
  
    <nav class="md-nav" aria-label="docker-compose安装">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#apt" class="md-nav__link">
    <span class="md-ellipsis">
      apt安装
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#docker_1" class="md-nav__link">
    <span class="md-ellipsis">
      docker国内镜像
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#docker_2" class="md-nav__link">
    <span class="md-ellipsis">
      docker走代理
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wsldocker" class="md-nav__link">
    <span class="md-ellipsis">
      WSL设置docker代理
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#portainerdocker" class="md-nav__link">
    <span class="md-ellipsis">
      Portainer(docker面板)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#grafana" class="md-nav__link">
    <span class="md-ellipsis">
      Grafana
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#uptime-kuma" class="md-nav__link">
    <span class="md-ellipsis">
      uptime-kuma(应用监控)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#minio" class="md-nav__link">
    <span class="md-ellipsis">
      minio(分布式对象存储服务器)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sun-panel" class="md-nav__link">
    <span class="md-ellipsis">
      sun-panel
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1panellinux" class="md-nav__link">
    <span class="md-ellipsis">
      1panel(Linux运维面板)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code-server" class="md-nav__link">
    <span class="md-ellipsis">
      code-server
    </span>
  </a>
  
    <nav class="md-nav" aria-label="code-server">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#coderconcode-server" class="md-nav__link">
    <span class="md-ellipsis">
      codercon/code-server
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linuxservercode-server" class="md-nav__link">
    <span class="md-ellipsis">
      linuxserver/code-server
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mysql8" class="md-nav__link">
    <span class="md-ellipsis">
      mysql8部署
    </span>
  </a>
  
    <nav class="md-nav" aria-label="mysql8部署">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      部署命令
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      配置命令
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mysql57" class="md-nav__link">
    <span class="md-ellipsis">
      mysql5.7部署
    </span>
  </a>
  
    <nav class="md-nav" aria-label="mysql5.7部署">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      部署命令
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      配置命令
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mongodb" class="md-nav__link">
    <span class="md-ellipsis">
      mongodb部署
    </span>
  </a>
  
    <nav class="md-nav" aria-label="mongodb部署">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      部署命令
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#apache2" class="md-nav__link">
    <span class="md-ellipsis">
      apache2部署
    </span>
  </a>
  
    <nav class="md-nav" aria-label="apache2部署">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      部署命令
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      配置命令
    </span>
  </a>
  
    <nav class="md-nav" aria-label="配置命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      修改中文显示
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      设置需要密码访问
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#404" class="md-nav__link">
    <span class="md-ellipsis">
      自定义404等页面
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#navidrome" class="md-nav__link">
    <span class="md-ellipsis">
      navidrome自建音乐播放器
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jellyfin" class="md-nav__link">
    <span class="md-ellipsis">
      jellyfin
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kodexplorer" class="md-nav__link">
    <span class="md-ellipsis">
      kodexplorer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="kodexplorer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      1.快速启动
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      2.实现数据持久化——创建数据目录并在启动时挂载
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      3.禁止更新：
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nextcloud" class="md-nav__link">
    <span class="md-ellipsis">
      nextcloud部署
    </span>
  </a>
  
    <nav class="md-nav" aria-label="nextcloud部署">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      部署命令
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nextcloud-0770" class="md-nav__link">
    <span class="md-ellipsis">
      错误：nextcloud 您的数据目录可被其他用户读取 请更改权限为 0770 以避免其他用户查看目录
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nextcloud-ipip" class="md-nav__link">
    <span class="md-ellipsis">
      Nextcloud 通过不被信任的域名访问 动态IP解决方案，允许所有IP访问
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#onlyoffice" class="md-nav__link">
    <span class="md-ellipsis">
      onlyoffice部署
    </span>
  </a>
  
    <nav class="md-nav" aria-label="onlyoffice部署">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      部署命令
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      配置命令
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nextcloudonlyoffice" class="md-nav__link">
    <span class="md-ellipsis">
      nextcloud与onlyoffice链接
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jupyterbase-notebook" class="md-nav__link">
    <span class="md-ellipsis">
      jupyter/base-notebook配置
    </span>
  </a>
  
    <nav class="md-nav" aria-label="jupyter/base-notebook配置">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      镜像拉取
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      创建容器
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      修改中文
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rtmp" class="md-nav__link">
    <span class="md-ellipsis">
      rtmp
    </span>
  </a>
  
    <nav class="md-nav" aria-label="rtmp">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#to-stream-to-the-server" class="md-nav__link">
    <span class="md-ellipsis">
      To stream to the server
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calibre-web" class="md-nav__link">
    <span class="md-ellipsis">
      calibre-web部署
    </span>
  </a>
  
    <nav class="md-nav" aria-label="calibre-web部署">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#user-group-identifiers" class="md-nav__link">
    <span class="md-ellipsis">
      User / Group Identifiers
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#teamspeak" class="md-nav__link">
    <span class="md-ellipsis">
      teamspeak部署
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kmswindoowsoffice" class="md-nav__link">
    <span class="md-ellipsis">
      kms服务器部署及windoows+office激活
    </span>
  </a>
  
    <nav class="md-nav" aria-label="kms服务器部署及windoows+office激活">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      服务器部署
    </span>
  </a>
  
    <nav class="md-nav" aria-label="服务器部署">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#amogekovlmcsd" class="md-nav__link">
    <span class="md-ellipsis">
      镜像A：mogeko/vlmcsd
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bluodaoyikms-server" class="md-nav__link">
    <span class="md-ellipsis">
      镜像B：luodaoyi/kms-server
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#docker-compose-sparkhadoop" class="md-nav__link">
    <span class="md-ellipsis">
      docker-compose spark+hadoop部署
    </span>
  </a>
  
    <nav class="md-nav" aria-label="docker-compose spark+hadoop部署">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    <span class="md-ellipsis">
      部署命令
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#docker-composesparkhadoop" class="md-nav__link">
    <span class="md-ellipsis">
      docker-compose搭建spark+hadoop集群
    </span>
  </a>
  
    <nav class="md-nav" aria-label="docker-compose搭建spark+hadoop集群">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1dockerdocker-compose" class="md-nav__link">
    <span class="md-ellipsis">
      1、安装docker和docker-Compose
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1、安装docker和docker-Compose">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11docker" class="md-nav__link">
    <span class="md-ellipsis">
      1.1、安装docker
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12docker-compose" class="md-nav__link">
    <span class="md-ellipsis">
      1.2、安装docker-Compose
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2sparkhdfs" class="md-nav__link">
    <span class="md-ellipsis">
      2、极速搭建Spark集群（含HDFS集群）
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2、极速搭建Spark集群（含HDFS集群）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21hadoopenv" class="md-nav__link">
    <span class="md-ellipsis">
      2.1、编辑hadoop.env配置文件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22docker-composeyml" class="md-nav__link">
    <span class="md-ellipsis">
      2.2、编辑docker-compose.yml编排配置文件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13datanode6workeryml" class="md-nav__link">
    <span class="md-ellipsis">
      1、此为（3datanode+6worker）的yml文件示例
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22datanode3workeryml" class="md-nav__link">
    <span class="md-ellipsis">
      2、此为（2datanode+3worker）的yml文件示例
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23docker-compose" class="md-nav__link">
    <span class="md-ellipsis">
      2.3、执行docker-compose命令，一键搭建集群
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24" class="md-nav__link">
    <span class="md-ellipsis">
      2.4、查看集群环境
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3spark" class="md-nav__link">
    <span class="md-ellipsis">
      3、spark集群开机自启动
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3、spark集群开机自启动">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31" class="md-nav__link">
    <span class="md-ellipsis">
      3.1、自定义系统服务
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32" class="md-nav__link">
    <span class="md-ellipsis">
      3.2、设置服务为随系统自启
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#v2ray-core" class="md-nav__link">
    <span class="md-ellipsis">
      v2ray-core
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nginx-proxy-manager" class="md-nav__link">
    <span class="md-ellipsis">
      nginx-proxy-manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openvpn" class="md-nav__link">
    <span class="md-ellipsis">
      openvpn
    </span>
  </a>
  
    <nav class="md-nav" aria-label="openvpn">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_1" class="md-nav__link">
    <span class="md-ellipsis">
      教程1：
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_1" class="md-nav__link">
    <span class="md-ellipsis">
      教程2：
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openvpn-as" class="md-nav__link">
    <span class="md-ellipsis">
      ××openvpn-as
    </span>
  </a>
  
    <nav class="md-nav" aria-label="××openvpn-as">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zh-cn" class="md-nav__link">
    <span class="md-ellipsis">
      zh-cn:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#en" class="md-nav__link">
    <span class="md-ellipsis">
      en:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qbittorrent" class="md-nav__link">
    <span class="md-ellipsis">
      qbittorrent
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Docker</h1>

<h4 id="docker">docker安装</h4>
<h5 id="for-ubuntu">官方教程 for Ubuntu</h5>
<pre><code class="language-shell">#Uninstall old versions
#Older versions of Docker were called docker, docker.io, or docker-engine. If these are installed, uninstall them:
sudo apt-get remove docker docker-engine docker.io containerd runc

#Install using the repository
#Before you install Docker Engine for the first time on a new host machine, you need to set up the Docker repository. Afterward, you can install and update Docker from the repository.
#Set up the repository
#Update the apt package index and install packages to allow apt to use a repository over HTTPS:
sudo apt-get update
sudo apt-get install \
    ca-certificates \
    curl \
    gnupg \
    lsb-release

#Add Docker’s official GPG key:
sudo mkdir -p /etc/apt/keyrings
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg

#Use the following command to set up the repository:
echo \
  &quot;deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu \
  $(lsb_release -cs) stable&quot; | sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null

#Install Docker Engine
#Update the apt package index, and install the latest version of Docker Engine, containerd, and Docker Compose, or go to the next step to install a specific version:
sudo apt-get update
sudo apt-get install docker-ce docker-ce-cli containerd.io docker-compose-plugin
</code></pre>
<h5 id="tsinghua">使用Tsinghua源</h5>
<pre><code class="language-shell">#如果你过去安装过 docker,先删掉:
sudo apt-get remove docker docker-engine docker.io containerd runc

#首先安装依赖:
sudo apt-get install apt-transport-https ca-certificates curl gnupg2 software-properties-common

#根据你的发行版，下面的内容有所不同。
#Ubuntu
#信任 Docker 的 GPG 公钥:
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg

#添加软件仓库:
echo \
  &quot;deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/ubuntu \
  $(lsb_release -cs) stable&quot; | sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null

#最后安装
sudo apt-get update
sudo apt-get install docker-ce

#Fedora/CentOS/RHEL
#以下内容根据 官方文档 修改而来。
#如果你之前安装过 docker，请先删掉
sudo yum remove docker docker-client docker-client-latest docker-common docker-latest docker-latest-logrotate docker-logrotate docker-engine

#安装一些依赖
sudo yum install -y yum-utils device-mapper-persistent-data lvm2

#根据你的发行版下载repo文件: CentOS/RHEL
yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo

#把软件仓库地址替换为 TUNA:
sudo sed -i 's+download.docker.com+mirrors.tuna.tsinghua.edu.cn/docker-ce+' /etc/yum.repos.d/docker-ce.repo

#最后安装:
sudo yum makecache fast
sudo yum install docker-ce
</code></pre>
<h5 id="_1">使用阿里源(推荐使用)</h5>
<pre><code class="language-shell">#Ubuntu 14.04/16.04（使用 apt-get 进行安装）
# step 1: 安装必要的一些系统工具
sudo apt-get update
sudo apt-get -y install apt-transport-https ca-certificates curl software-properties-common
# step 2: 安装GPG证书
curl -fsSL https://mirrors.aliyun.com/docker-ce/linux/ubuntu/gpg | sudo apt-key add -
# Step 3: 写入软件源信息
sudo add-apt-repository &quot;deb [arch=amd64] https://mirrors.aliyun.com/docker-ce/linux/ubuntu $(lsb_release -cs) stable&quot;
# Step 4: 更新并安装Docker-CE
sudo apt-get -y update
sudo apt-get -y install docker-ce

# 安装指定版本的Docker-CE:
# Step 1: 查找Docker-CE的版本:
# apt-cache madison docker-ce
#   docker-ce | 17.03.1~ce-0~ubuntu-xenial | https://mirrors.aliyun.com/docker-ce/linux/ubuntu xenial/stable amd64 Packages
#   docker-ce | 17.03.0~ce-0~ubuntu-xenial | https://mirrors.aliyun.com/docker-ce/linux/ubuntu xenial/stable amd64 Packages
# Step 2: 安装指定版本的Docker-CE: (VERSION例如上面的17.03.1~ce-0~ubuntu-xenial)
# sudo apt-get -y install docker-ce=[VERSION]



#CentOS 7（使用 yum 进行安装）
# step 1: 安装必要的一些系统工具
sudo yum install -y yum-utils device-mapper-persistent-data lvm2
# Step 2: 添加软件源信息
sudo yum-config-manager --add-repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo
# Step 3
sudo sed -i 's+download.docker.com+mirrors.aliyun.com/docker-ce+' /etc/yum.repos.d/docker-ce.repo
# Step 4: 更新并安装Docker-CE
sudo yum makecache fast
sudo yum -y install docker-ce
# Step 4: 开启Docker服务
sudo service docker start

# 注意：
# 官方软件源默认启用了最新的软件，您可以通过编辑软件源的方式获取各个版本的软件包。例如官方并没有将测试版本的软件源置为可用，您可以通过以下方式开启。同理可以开启各种测试版本等。
# vim /etc/yum.repos.d/docker-ce.repo
#   将[docker-ce-test]下方的enabled=0修改为enabled=1
#
# 安装指定版本的Docker-CE:
# Step 1: 查找Docker-CE的版本:
# yum list docker-ce.x86_64 --showduplicates | sort -r
#   Loading mirror speeds from cached hostfile
#   Loaded plugins: branch, fastestmirror, langpacks
#   docker-ce.x86_64            17.03.1.ce-1.el7.centos            docker-ce-stable
#   docker-ce.x86_64            17.03.1.ce-1.el7.centos            @docker-ce-stable
#   docker-ce.x86_64            17.03.0.ce-1.el7.centos            docker-ce-stable
#   Available Packages
# Step2: 安装指定版本的Docker-CE: (VERSION例如上面的17.03.0.ce.1-1.el7.centos)
# sudo yum -y install docker-ce-[VERSION]
</code></pre>
<h5 id="ustc">使用ustc源</h5>
<pre><code class="language-shell">#安装 Docker CE，请按照 官方安装文档 ，选择你对应的系统。 以 Ubuntu 为例，参考 官方 Ubuntu 安装 Docker CE 手册 进行安装。 在阅读官方安装手册时，只要把 download.docker.com 地址换成 mirrors.ustc.edu.cn/docker-ce 即可。
#CentOS、 Fedora 等用户在下载 docker-ce.repo 文件后（位于 /etc/yum.repos.d/）， 还需要将该文件中的 download.docker.com 地址换成 mirrors.ustc.edu.cn/docker-ce。


#Uninstall old versions
#Older versions of Docker were called docker, docker.io, or docker-engine. If these are installed, uninstall them:
sudo apt-get remove docker docker-engine docker.io containerd runc

#Install using the repository
#Before you install Docker Engine for the first time on a new host machine, you need to set up the Docker repository. Afterward, you can install and update Docker from the repository.
#Set up the repository
#Update the apt package index and install packages to allow apt to use a repository over HTTPS:
sudo apt-get update
sudo apt-get install \
    ca-certificates \
    curl \
    gnupg \
    lsb-release

#Add Docker’s official GPG key:
sudo mkdir -p /etc/apt/keyrings
curl -fsSL https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg

#Use the following command to set up the repository:
echo \
  &quot;deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu \
  $(lsb_release -cs) stable&quot; | sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null

#Install Docker Engine
#Update the apt package index, and install the latest version of Docker Engine, containerd, and Docker Compose, or go to the next step to install a specific version:
sudo apt-get update
sudo apt-get install docker-ce docker-ce-cli containerd.io docker-compose-plugin
</code></pre>
<h5 id="sjtu">使用sjtu源</h5>
<pre><code class="language-shell">#如果你过去安装过 docker，先删掉:
sudo apt-get remove docker docker-engine docker.io
#首先安装依赖:
sudo apt-get install apt-transport-https ca-certificates curl gnupg2 software-properties-common
#根据你的发行版，下面的内容有所不同。你使用的发行版：


#Debian
#信任 Docker 的 GPG 公钥:
curl -fsSL https://download.docker.com/linux/debian/gpg | sudo apt-key add -
#对于 amd64 架构的计算机，添加软件仓库:
sudo add-apt-repository \
   &quot;deb [arch=amd64] https://mirror.sjtu.edu.cn/docker-ce/linux/debian \
   $(lsb_release -cs) \
   stable&quot;
#如果你用的是树莓派或其它ARM架构计算机，请运行:
echo &quot;deb [arch=armhf] https://mirror.sjtu.edu.cn/docker-ce/linux/debian \
     $(lsb_release -cs) stable&quot; | \
    sudo tee /etc/apt/sources.list.d/docker.list
#最后安装
sudo apt-get update
sudo apt-get install docker-ce


#Ubuntu
#信任 Docker 的 GPG 公钥:
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -
#对于 amd64 架构的计算机，添加软件仓库:
sudo add-apt-repository \
   &quot;deb [arch=amd64] https://mirror.sjtu.edu.cn/docker-ce/linux/ubuntu \
   $(lsb_release -cs) \
   stable&quot;
#如果你用的是树莓派或其它ARM架构计算机，请运行:
echo &quot;deb [arch=armhf] https://mirror.sjtu.edu.cn/docker-ce/linux/ubuntu \
     $(lsb_release -cs) stable&quot; | \
    sudo tee /etc/apt/sources.list.d/docker.list
#最后安装
sudo apt-get update
sudo apt-get install docker-ce


#Fedora/CentOS/RHEL
#以下内容根据TUNA文档修改而来。
#如果你之前安装过 docker，请先删掉
sudo yum remove docker docker-common docker-selinux docker-engine
#安装一些依赖
sudo yum install -y yum-utils device-mapper-persistent-data lvm2
#根据你的发行版下载repo文件:


#CentOS/RHEL
#Fedora
#把软件仓库地址替换为 SJTUG:
sudo sed -i 's+download.docker.com+mirror.sjtu.edu.cn/docker-ce+' /etc/yum.repos.d/docker-ce.repo
#最后安装:
sudo yum makecache fast
sudo yum install docker-ce
</code></pre>
<h4 id="docker-compose">docker-compose安装</h4>
<h5 id="apt">apt安装</h5>
<p>直接使用apt-get install</p>
<pre><code class="language-bash">sudo apt-get install docker-compose
</code></pre>
<h4 id="docker_1">docker国内镜像</h4>
<p>https://fast360.xyz/</p>
<p>https://www.cnblogs.com/OneSeting/p/18532166</p>
<p>https://cloud.tencent.com/developer/article/2485043</p>
<p>https://xuanyuan.me/blog/archives/1154</p>
<p>在<code>/etc/docker/daemon.json</code>中添加镜像地址，如：</p>
<pre><code class="language-json">{
    &quot;registry-mirrors&quot;: [
        &quot;https://hub.fast360.xyz&quot;
    ]
}
</code></pre>
<h4 id="docker_2">docker走代理</h4>
<pre><code class="language-bash">sudo cd /etc/systemd/system/
#创建配置文件
sudo mkdir docker.service.d
cd docker.service.d
sudo vim proxy.conf

#切换到插入模式，插入以下内容
[Service]
Environment=&quot;HTTP_PROXY=127.0.0.1:7890&quot;
Environment=&quot;HTTPS_PROXY=127.0.0.1:7890&quot;
#保存退出

#重启docker
sudo systemctl daemon-reload
sudo systemctl restart docker

#最后我们仍然是验证一下是否修改成功，运行
sudo docker info
#在长串info信息中如果出现类似下文的内容：
# HTTP Proxy: 代理服务器ip:port
# HTTPS Proxy: 代理服务器ip:port
</code></pre>
<h4 id="wsldocker">WSL设置docker代理</h4>
<p>当启动docker服务时，后调用<code>/etc/init.d/docker</code>脚本，而此脚本会执行<code>/etc/default/docker</code>脚本，因此可在后者设置代理的环境变量，由此docker拉取镜像时便会使用代理。</p>
<p>修改<code>/etc/default/docker</code>文件，加入以下内容:</p>
<pre><code class="language-bash">export http_proxy=&quot;127.0.0.1:7890&quot;
export https_proxy=&quot;127.0.0.1:7890&quot;
# 注意：https代理链接为http，Windows IP即为宿主机IP
</code></pre>
<p>重启docker：sudo service docker restart</p>
<h4 id="portainerdocker">Portainer(docker面板)</h4>
<pre><code class="language-bash">#拉取镜像
sudo docker pull portainer/portainer-ce:latest
</code></pre>
<p>创建并启动容器</p>
<pre><code class="language-bash">#不映射数据
sudo docker run -d -p 8000:8000 -p 9443:9443 -p 9000:9000 --name portainer --restart=always -v /var/run/docker.sock:/var/run/docker.sock portainer/portainer-ce:latest
</code></pre>
<pre><code class="language-bash">#映射数据至指定目录
sudo mkdir -p /mnt/toshiba/docker/portainer-default/
sudo chown ubuntu /mnt/toshiba/docker/portainer-default/
sudo docker run -d -p 8000:8000 -p 9443:9443 -p 9000:9000 --name portainer --restart=always -v /var/run/docker.sock:/var/run/docker.sock -v /mnt/toshiba/docker/portainer-default:/data portainer/portainer-ce:latest
</code></pre>
<p>创建完毕后，访问9000端口。</p>
<h4 id="grafana">Grafana</h4>
<pre><code class="language-bash">docker run -d --name=grafana -p 3000:3000 grafana/grafana

docker run -d --name=grafana -p 3000:3000 grafana/grafana-enterprise
</code></pre>
<h4 id="uptime-kuma">uptime-kuma(应用监控)</h4>
<pre><code class="language-bash">sudo docker pull elestio/uptime-kuma:1.23.10

sudo docker run -itd --name uptime-kuma-default -p 13001:3001  elestio/uptime-kuma:1.23.10
</code></pre>
<h4 id="minio">minio(分布式对象存储服务器)</h4>
<pre><code class="language-bash">sudo docker pull minio/minio:latest
sudo mkdir -p /mnt/toshiba/docker/minio-default/data
sudo chown ubuntu /mnt/toshiba/docker/minio-default/data
sudo mkdir -p /mnt/toshiba/docker/minio-default/config
sudo chown ubuntu /mnt/toshiba/docker/minio-default/config
# 指定用户名和密码
sudo docker run -itd --restart=always --name minio-default -p 9900:9000 -p 9901:9001 -v /mnt/toshiba/docker/minio-default/data:/data -v /mnt/toshiba/docker/minio-default/config:/root/.minio -e &quot;MINIO_ROOT_USER=minioadmin&quot; -e &quot;MINIO_ROOT_PASSWORD=10203090&quot; minio/minio:latest server /data --console-address &quot;:9001&quot;


# 不指定用户名和密码，默认为minioadmin,minioadmin
sudo docker run -itd --restart=always --name minio-default -p 9900:9000 -p 9901:9001 -v /mnt/toshiba/docker/minio-default/data:/data -v /mnt/toshiba/docker/minio-default/config:/root/.minio minio/minio:latest server /data --console-address &quot;:9001&quot;


</code></pre>
<h4 id="sun-panel">sun-panel</h4>
<pre><code class="language-bash">sudo docker run -d --restart=always -p 8226:3002 -v ~/docker_data/sun-panel/conf:/app/conf -v /var/run/docker.sock:/var/run/docker.sock --name sun-panel hslr/sun-panel:1.5.2
</code></pre>
<p>默认账号密码</p>
<p>账号：admin@sun.cc</p>
<p>密码：12345678</p>
<h4 id="1panellinux">1panel(Linux运维面板)</h4>
<p>https://hub.docker.com/r/moelin/1panel</p>
<p>由于容器内部<code>systemd</code>限制，部分功能目前尚不完整。</p>
<p><strong>20230919：添加自动修改面板显示应用版本，无需手动修改数据库</strong></p>
<p>相关操作查看下文。</p>
<ol>
<li>默认端口：<code>10086</code></li>
<li>默认账户：<code>1panel</code></li>
<li>默认密码：<code>1panel_password</code></li>
<li>默认入口：<code>entrance</code></li>
</ol>
<p>docker方式安装：</p>
<pre><code class="language-bash">sudo docker pull moelin/1panel:v1.10.1-lts

sudo docker run -d --name 1panel-default --restart always --network host -p 10086:10086 -v /var/run/docker.sock:/var/run/docker.sock -v /var/lib/docker/volumes:/var/lib/docker/volumes -v /opt:/opt -v /root:/root -e TZ=Asia/Shanghai moelin/1panel:v1.10.1-lts
</code></pre>
<p>docker-compose方式安装：</p>
<pre><code class="language-yaml">#创建一个docker-compose.yml文件，内容类似如下
version: '3'
services:
  1panel:
    container_name: 1panel # 容器名
    restart: always
    network_mode: &quot;host&quot;
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - /var/lib/docker/volumes:/var/lib/docker/volumes
      - /opt:/opt  # 文件存储映射
      - /root:/root  # 可选的文件存储映射
    environment:
      - TZ=Asia/Shanghai  # 时区设置
    image: moelin/1panel:latest
    labels:  
      createdBy: &quot;Apps&quot;
#然后docker-compose up -d运行
</code></pre>
<h4 id="code-server">code-server</h4>
<h5 id="coderconcode-server">codercon/code-server</h5>
<pre><code class="language-bash">#sudo docker pull codercom/code-server:4.89.1-39
sudo docker pull codercom/code-server:latest
sudo mkdir -p /home/ubuntu/docker/code-server/project/
sudo mkdir -p /home/ubuntu/docker/code-server/.config/

#sudo docker run -itd --name code-server-default -p 8240:8080 -v &quot;/home/ubuntu/docker/code-server/.config:/home/coder/.config&quot; -v &quot;/home/ubuntu/docker/code-server/project:/home/coder/project&quot; -u &quot;$(id -u):$(id -g)&quot; -e &quot;DOCKER_USER=$USER&quot; codercom/code-server:4.89.1-39

sudo docker run -itd --name code-server-default -p 8240:8080 -v &quot;/home/ubuntu/docker/code-server/.config:/home/coder/.config&quot; -v &quot;/home/ubuntu/docker/code-server/project:/home/coder/project&quot; -u &quot;$(id -u):$(id -g)&quot; -e &quot;DOCKER_USER=$USER&quot; codercom/code-server:latest

#sudo docker run -itd --name code-server-default -p 8240:8080 -v &quot;/home/ubuntu/docker/code-server/.config:/home/coder/.config&quot; -v &quot;/home/ubuntu/docker/code-server/project:/home/coder/project&quot; -u &quot;$(id -u):$(id -g)&quot; -e &quot;DOCKER_USER=$USER&quot; -e PASSWORD=123456 codercom/code-server:latest
</code></pre>
<p>密码在<code>.config/code-server/config.yaml</code>中。</p>
<h5 id="linuxservercode-server">linuxserver/code-server</h5>
<pre><code class="language-bash">#docker pull linuxserver/code-server:4.89.1
docker pull linuxserver/code-server:latest
sudo mkdir -p /home/ubuntu/docker/code-server/project/
sudo mkdir -p /home/ubuntu/docker/code-server/config/

#docker run -d --name=code-server -e PUID=1000 -e PGID=1000 -e TZ=Etc/UTC -e PASSWORD=password -e SUDO_PASSWORD=password -e DEFAULT_WORKSPACE=/config/workspace -p 8240:8443 -v /home/ubuntu/docker/code-server/config:/config --restart unless-stopped linuxserver/code-server:4.89.1

docker run -d --name=code-server -e PUID=1000 -e PGID=1000 -e TZ=Etc/UTC -e PASSWORD=password -e SUDO_PASSWORD=password -e DEFAULT_WORKSPACE=/config/workspace -p 8240:8443 -v /home/ubuntu/docker/code-server/config:/config --restart unless-stopped linuxserver/code-server:latest
</code></pre>
<h4 id="mysql8">mysql8部署</h4>
<h5 id="_2">部署命令</h5>
<p>拉取镜像</p>
<pre><code class="language-shell">sudo docker pull mysql
</code></pre>
<p>运行</p>
<pre><code class="language-shell">#创建映射目录
sudo mkdir -p /home/ubuntu/docker/mysql-default/conf
sudo mkdir -p /home/ubuntu/docker/mysql-default/logs
sudo mkdir -p /home/ubuntu/docker/mysql-default/data

#启动容器
sudo docker run -it --name mysql-default -p 3080:3306 -e MYSQL_ROOT_PASSWORD=123456 --restart=always -v /home/ubuntu/docker/mysql-default/conf:/etc/mysql/conf.d -v /home/ubuntu/docker/mysql-default/logs:/var/log/mysql -v /home/ubuntu/docker/mysql-default/data:/var/lib/mysql mysql

# 报错：[ERROR] [Entrypoint]: mysqld failed while attempting to check config
#        command was: mysqld --verbose --help --log-bin-index=/tmp/tmp.UI6ajKmnml
#        mysqld: Can't read dir of '/etc/mysql/conf.d/' (OS errno 2 - No such file or #directory)
# mysql5.7的配置在 /etc/mysql
# mysql8.0以上的配置位置在 /etc/mysql/conf.d
#/mydata/mysql/conf:/etc/mysql
#                   ||
#                   ||
#                   ||
#                   \/
#/mydata/mysql/conf:/etc/mysql/conf.d
</code></pre>
<h5 id="_3">配置命令</h5>
<p>进入容器</p>
<pre><code class="language-shell">sudo docker exec -it mysql-default /bin/bash
</code></pre>
<h4 id="mysql57">mysql5.7部署</h4>
<h5 id="_4">部署命令</h5>
<p>拉取镜像</p>
<pre><code class="language-shell">sudo docker pull mysql:5.7
</code></pre>
<p>运行</p>
<pre><code class="language-shell">#创建映射目录
sudo mkdir -p /home/ubuntu/docker/mysql5-default/conf
sudo mkdir -p /home/ubuntu/docker/mysql5-default/logs
sudo mkdir -p /home/ubuntu/docker/mysql5-default/mysql

#创建配置文件
cd /home/ubuntu/docker/mysql5-default/conf/
sudo vi my.cnf
‘’‘
# Copyright (c) 2014, 2016, Oracle and/or its affiliates. All rights reserved.
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; version 2 of the License.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program; if not, write to the Free Software
# Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301 USA

#
# The MySQL  Server configuration file.
#
# For explanations see
# http://dev.mysql.com/doc/mysql/en/server-system-variables.html

[mysqld]
pid-file    = /var/run/mysqld/mysqld.pid
socket      = /var/run/mysqld/mysqld.sock
datadir     = /var/lib/mysql
#log-error  = /var/log/mysql/error.log
# Disabling symbolic-links is recommended to prevent assorted security risks
symbolic-links=0

max_connections = 2000
max_user_connections = 1900
max_connect_errors = 100000
max_allowed_packet = 50M
lower_case_table_names=1
[mysqld]
skip-name-resolve
sql_mode=STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION
’‘’
#保存后退出


#启动容器
sudo docker run  -p 3090:3306 --name mysql5-default --restart=always -v /home/ubuntu/docker/mysql5-default/conf/my.cnf:/etc/mysql/my.cnf -v /home/ubuntu/docker/mysql5-default/logs:/logs -v /home/ubuntu/docker/mysql5-default/mysql:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 -d mysql:5.7
</code></pre>
<h5 id="_5">配置命令</h5>
<pre><code>sudo docker exec -it mysql5-default /bin/bash
</code></pre>
<h4 id="mongodb">mongodb部署</h4>
<h5 id="_6">部署命令</h5>
<p>拉取镜像</p>
<pre><code class="language-bash">sudo docker pull mongo
</code></pre>
<p>运行</p>
<pre><code class="language-bash">sudo docker run --name=mongodb-default --restart=always -p 27017:27017 -itd -v /home/ubuntu/docker/mongodb-default/data:/data/db -v/home/ubuntu/docker/mongodb-default/backup:/data/backup -v /home/ubuntu/docker/mongodb-default/conf:/data/configdb mongo --auth
</code></pre>
<p>进入mongo容器</p>
<pre><code class="language-bash">sudo docker exec -it mongodb-default mongosh admin
</code></pre>
<p>添加账号</p>
<pre><code class="language-bash">db.createUser({user:'admin',pwd:'123456',roles:[{role:'root',db:'admin'}],});
db.auth('admin','123456');
#读取权限的账户
db.createUser({user:'user',pwd:'123456',roles:[{role:&quot;readWrite&quot;,db:&quot;elec_safe&quot;}]});
db.auth(&quot;user&quot;,&quot;123456&quot;);
</code></pre>
<h4 id="apache2">apache2部署</h4>
<h5 id="_7">部署命令</h5>
<p>拉取镜像</p>
<pre><code class="language-shell">sudo docker pull httpd
</code></pre>
<p>运行</p>
<p>注：若容器运行后自动无限重启，可使用<code>sudo docker logs httpd-default</code>查看日志输出。</p>
<p>如果输出日志报错<code>AH00534: httpd............</code>，则根据以下命令，在启动容器前先修改httpd.conf的内容/或直接复制全新的httpd.conf。</p>
<pre><code class="language-shell">#创建映射目录
sudo mkdir -p /home/ubuntu/docker/httpd-default/htdocs
sudo mkdir -p /home/ubuntu/docker/httpd-default/conf
sudo touch /home/ubuntu/docker/httpd-default/conf/httpd.conf
sudo mkdir -p /home/ubuntu/docker/httpd-default/logs

#编辑httpd.conf文件内容
'''
#
# This is the main Apache HTTP server configuration file.  It contains the
# configuration directives that give the server its instructions.
# See &lt;URL:http://httpd.apache.org/docs/2.4/&gt; for detailed information.
# In particular, see 
# &lt;URL:http://httpd.apache.org/docs/2.4/mod/directives.html&gt;
# for a discussion of each configuration directive.
#
# Do NOT simply read the instructions in here without understanding
# what they do.  They're here only as hints or reminders.  If you are unsure
# consult the online docs. You have been warned.  
#
# Configuration and logfile names: If the filenames you specify for many
# of the server's control files begin with &quot;/&quot; (or &quot;drive:/&quot; for Win32), the
# server will use that explicit path.  If the filenames do *not* begin
# with &quot;/&quot;, the value of ServerRoot is prepended -- so &quot;logs/access_log&quot;
# with ServerRoot set to &quot;/usr/local/apache2&quot; will be interpreted by the
# server as &quot;/usr/local/apache2/logs/access_log&quot;, whereas &quot;/logs/access_log&quot; 
# will be interpreted as '/logs/access_log'.

#
# ServerRoot: The top of the directory tree under which the server's
# configuration, error, and log files are kept.
#
# Do not add a slash at the end of the directory path.  If you point
# ServerRoot at a non-local disk, be sure to specify a local disk on the
# Mutex directive, if file-based mutexes are used.  If you wish to share the
# same ServerRoot for multiple httpd daemons, you will need to change at
# least PidFile.
#
ServerRoot &quot;/usr/local/apache2&quot;

#
# Mutex: Allows you to set the mutex mechanism and mutex file directory
# for individual mutexes, or change the global defaults
#
# Uncomment and change the directory if mutexes are file-based and the default
# mutex file directory is not on a local disk or is not appropriate for some
# other reason.
#
# Mutex default:logs

#
# Listen: Allows you to bind Apache to specific IP addresses and/or
# ports, instead of the default. See also the &lt;VirtualHost&gt;
# directive.
#
# Change this to Listen on specific IP addresses as shown below to 
# prevent Apache from glomming onto all bound IP addresses.
#
#Listen 12.34.56.78:80
Listen 80

#
# Dynamic Shared Object (DSO) Support
#
# To be able to use the functionality of a module which was built as a DSO you
# have to place corresponding `LoadModule' lines at this location so the
# directives contained in it are actually available _before_ they are used.
# Statically compiled modules (those listed by `httpd -l') do not need
# to be loaded here.
#
# Example:
# LoadModule foo_module modules/mod_foo.so
#
LoadModule mpm_event_module modules/mod_mpm_event.so
#LoadModule mpm_prefork_module modules/mod_mpm_prefork.so
#LoadModule mpm_worker_module modules/mod_mpm_worker.so
LoadModule authn_file_module modules/mod_authn_file.so
#LoadModule authn_dbm_module modules/mod_authn_dbm.so
#LoadModule authn_anon_module modules/mod_authn_anon.so
#LoadModule authn_dbd_module modules/mod_authn_dbd.so
#LoadModule authn_socache_module modules/mod_authn_socache.so
LoadModule authn_core_module modules/mod_authn_core.so
LoadModule authz_host_module modules/mod_authz_host.so
LoadModule authz_groupfile_module modules/mod_authz_groupfile.so
LoadModule authz_user_module modules/mod_authz_user.so
#LoadModule authz_dbm_module modules/mod_authz_dbm.so
#LoadModule authz_owner_module modules/mod_authz_owner.so
#LoadModule authz_dbd_module modules/mod_authz_dbd.so
LoadModule authz_core_module modules/mod_authz_core.so
#LoadModule authnz_ldap_module modules/mod_authnz_ldap.so
#LoadModule authnz_fcgi_module modules/mod_authnz_fcgi.so
LoadModule access_compat_module modules/mod_access_compat.so
LoadModule auth_basic_module modules/mod_auth_basic.so
#LoadModule auth_form_module modules/mod_auth_form.so
#LoadModule auth_digest_module modules/mod_auth_digest.so
#LoadModule allowmethods_module modules/mod_allowmethods.so
#LoadModule isapi_module modules/mod_isapi.so
#LoadModule file_cache_module modules/mod_file_cache.so
#LoadModule cache_module modules/mod_cache.so
#LoadModule cache_disk_module modules/mod_cache_disk.so
#LoadModule cache_socache_module modules/mod_cache_socache.so
#LoadModule socache_shmcb_module modules/mod_socache_shmcb.so
#LoadModule socache_dbm_module modules/mod_socache_dbm.so
#LoadModule socache_memcache_module modules/mod_socache_memcache.so
#LoadModule socache_redis_module modules/mod_socache_redis.so
#LoadModule watchdog_module modules/mod_watchdog.so
#LoadModule macro_module modules/mod_macro.so
#LoadModule dbd_module modules/mod_dbd.so
#LoadModule bucketeer_module modules/mod_bucketeer.so
#LoadModule dumpio_module modules/mod_dumpio.so
#LoadModule echo_module modules/mod_echo.so
#LoadModule example_hooks_module modules/mod_example_hooks.so
#LoadModule case_filter_module modules/mod_case_filter.so
#LoadModule case_filter_in_module modules/mod_case_filter_in.so
#LoadModule example_ipc_module modules/mod_example_ipc.so
#LoadModule buffer_module modules/mod_buffer.so
#LoadModule data_module modules/mod_data.so
#LoadModule ratelimit_module modules/mod_ratelimit.so
LoadModule reqtimeout_module modules/mod_reqtimeout.so
#LoadModule ext_filter_module modules/mod_ext_filter.so
#LoadModule request_module modules/mod_request.so
#LoadModule include_module modules/mod_include.so
LoadModule filter_module modules/mod_filter.so
#LoadModule reflector_module modules/mod_reflector.so
#LoadModule substitute_module modules/mod_substitute.so
#LoadModule sed_module modules/mod_sed.so
#LoadModule charset_lite_module modules/mod_charset_lite.so
#LoadModule deflate_module modules/mod_deflate.so
#LoadModule xml2enc_module modules/mod_xml2enc.so
#LoadModule proxy_html_module modules/mod_proxy_html.so
#LoadModule brotli_module modules/mod_brotli.so
LoadModule mime_module modules/mod_mime.so
#LoadModule ldap_module modules/mod_ldap.so
LoadModule log_config_module modules/mod_log_config.so
#LoadModule log_debug_module modules/mod_log_debug.so
#LoadModule log_forensic_module modules/mod_log_forensic.so
#LoadModule logio_module modules/mod_logio.so
#LoadModule lua_module modules/mod_lua.so
LoadModule env_module modules/mod_env.so
#LoadModule mime_magic_module modules/mod_mime_magic.so
#LoadModule cern_meta_module modules/mod_cern_meta.so
#LoadModule expires_module modules/mod_expires.so
LoadModule headers_module modules/mod_headers.so
#LoadModule ident_module modules/mod_ident.so
#LoadModule usertrack_module modules/mod_usertrack.so
#LoadModule unique_id_module modules/mod_unique_id.so
LoadModule setenvif_module modules/mod_setenvif.so
LoadModule version_module modules/mod_version.so
#LoadModule remoteip_module modules/mod_remoteip.so
#LoadModule proxy_module modules/mod_proxy.so
#LoadModule proxy_connect_module modules/mod_proxy_connect.so
#LoadModule proxy_ftp_module modules/mod_proxy_ftp.so
#LoadModule proxy_http_module modules/mod_proxy_http.so
#LoadModule proxy_fcgi_module modules/mod_proxy_fcgi.so
#LoadModule proxy_scgi_module modules/mod_proxy_scgi.so
#LoadModule proxy_uwsgi_module modules/mod_proxy_uwsgi.so
#LoadModule proxy_fdpass_module modules/mod_proxy_fdpass.so
#LoadModule proxy_wstunnel_module modules/mod_proxy_wstunnel.so
#LoadModule proxy_ajp_module modules/mod_proxy_ajp.so
#LoadModule proxy_balancer_module modules/mod_proxy_balancer.so
#LoadModule proxy_express_module modules/mod_proxy_express.so
#LoadModule proxy_hcheck_module modules/mod_proxy_hcheck.so
#LoadModule session_module modules/mod_session.so
#LoadModule session_cookie_module modules/mod_session_cookie.so
#LoadModule session_crypto_module modules/mod_session_crypto.so
#LoadModule session_dbd_module modules/mod_session_dbd.so
#LoadModule slotmem_shm_module modules/mod_slotmem_shm.so
#LoadModule slotmem_plain_module modules/mod_slotmem_plain.so
#LoadModule ssl_module modules/mod_ssl.so
#LoadModule optional_hook_export_module modules/mod_optional_hook_export.so
#LoadModule optional_hook_import_module modules/mod_optional_hook_import.so
#LoadModule optional_fn_import_module modules/mod_optional_fn_import.so
#LoadModule optional_fn_export_module modules/mod_optional_fn_export.so
#LoadModule dialup_module modules/mod_dialup.so
#LoadModule http2_module modules/mod_http2.so
#LoadModule proxy_http2_module modules/mod_proxy_http2.so
#LoadModule md_module modules/mod_md.so
#LoadModule lbmethod_byrequests_module modules/mod_lbmethod_byrequests.so
#LoadModule lbmethod_bytraffic_module modules/mod_lbmethod_bytraffic.so
#LoadModule lbmethod_bybusyness_module modules/mod_lbmethod_bybusyness.so
#LoadModule lbmethod_heartbeat_module modules/mod_lbmethod_heartbeat.so
LoadModule unixd_module modules/mod_unixd.so
#LoadModule heartbeat_module modules/mod_heartbeat.so
#LoadModule heartmonitor_module modules/mod_heartmonitor.so
#LoadModule dav_module modules/mod_dav.so
LoadModule status_module modules/mod_status.so
LoadModule autoindex_module modules/mod_autoindex.so
#LoadModule asis_module modules/mod_asis.so
#LoadModule info_module modules/mod_info.so
#LoadModule suexec_module modules/mod_suexec.so
&lt;IfModule !mpm_prefork_module&gt;
    #LoadModule cgid_module modules/mod_cgid.so
&lt;/IfModule&gt;
&lt;IfModule mpm_prefork_module&gt;
    #LoadModule cgi_module modules/mod_cgi.so
&lt;/IfModule&gt;
#LoadModule dav_fs_module modules/mod_dav_fs.so
#LoadModule dav_lock_module modules/mod_dav_lock.so
#LoadModule vhost_alias_module modules/mod_vhost_alias.so
#LoadModule negotiation_module modules/mod_negotiation.so
LoadModule dir_module modules/mod_dir.so
#LoadModule imagemap_module modules/mod_imagemap.so
#LoadModule actions_module modules/mod_actions.so
#LoadModule speling_module modules/mod_speling.so
#LoadModule userdir_module modules/mod_userdir.so
LoadModule alias_module modules/mod_alias.so
#LoadModule rewrite_module modules/mod_rewrite.so

&lt;IfModule unixd_module&gt;
#
# If you wish httpd to run as a different user or group, you must run
# httpd as root initially and it will switch.  
#
# User/Group: The name (or #number) of the user/group to run httpd as.
# It is usually good practice to create a dedicated user and group for
# running httpd, as with most system services.
#
User www-data
Group www-data

&lt;/IfModule&gt;

# 'Main' server configuration
#
# The directives in this section set up the values used by the 'main'
# server, which responds to any requests that aren't handled by a
# &lt;VirtualHost&gt; definition.  These values also provide defaults for
# any &lt;VirtualHost&gt; containers you may define later in the file.
#
# All of these directives may appear inside &lt;VirtualHost&gt; containers,
# in which case these default settings will be overridden for the
# virtual host being defined.
#

#
# ServerAdmin: Your address, where problems with the server should be
# e-mailed.  This address appears on some server-generated pages, such
# as error documents.  e.g. admin@your-domain.com
#
ServerAdmin you@example.com

#
# ServerName gives the name and port that the server uses to identify itself.
# This can often be determined automatically, but we recommend you specify
# it explicitly to prevent problems during startup.
#
# If your host doesn't have a registered DNS name, enter its IP address here.
#
#ServerName www.example.com:80

#
# Deny access to the entirety of your server's filesystem. You must
# explicitly permit access to web content directories in other 
# &lt;Directory&gt; blocks below.
#
&lt;Directory /&gt;
    AllowOverride none
    Require all denied
&lt;/Directory&gt;

#
# Note that from this point forward you must specifically allow
# particular features to be enabled - so if something's not working as
# you might expect, make sure that you have specifically enabled it
# below.
#

#
# DocumentRoot: The directory out of which you will serve your
# documents. By default, all requests are taken from this directory, but
# symbolic links and aliases may be used to point to other locations.
#
DocumentRoot &quot;/usr/local/apache2/htdocs&quot;
&lt;Directory &quot;/usr/local/apache2/htdocs&quot;&gt;
    #
    # Possible values for the Options directive are &quot;None&quot;, &quot;All&quot;,
    # or any combination of:
    #   Indexes Includes FollowSymLinks SymLinksifOwnerMatch ExecCGI MultiViews
    #
    # Note that &quot;MultiViews&quot; must be named *explicitly* --- &quot;Options All&quot;
    # doesn't give it to you.
    #
    # The Options directive is both complicated and important.  Please see
    # http://httpd.apache.org/docs/2.4/mod/core.html#options
    # for more information.
    #
    Options Indexes FollowSymLinks

    #
    # AllowOverride controls what directives may be placed in .htaccess files.
    # It can be &quot;All&quot;, &quot;None&quot;, or any combination of the keywords:
    #   AllowOverride FileInfo AuthConfig Limit
    #
    AllowOverride None

    #
    # Controls who can get stuff from this server.
    #
    Require all granted
&lt;/Directory&gt;

#
# DirectoryIndex: sets the file that Apache will serve if a directory
# is requested.
#
&lt;IfModule dir_module&gt;
    DirectoryIndex index.html
&lt;/IfModule&gt;

#
# The following lines prevent .htaccess and .htpasswd files from being 
# viewed by Web clients. 
#
&lt;Files &quot;.ht*&quot;&gt;
    Require all denied
&lt;/Files&gt;

#
# ErrorLog: The location of the error log file.
# If you do not specify an ErrorLog directive within a &lt;VirtualHost&gt;
# container, error messages relating to that virtual host will be
# logged here.  If you *do* define an error logfile for a &lt;VirtualHost&gt;
# container, that host's errors will be logged there and not here.
#
ErrorLog /proc/self/fd/2

#
# LogLevel: Control the number of messages logged to the error_log.
# Possible values include: debug, info, notice, warn, error, crit,
# alert, emerg.
#
LogLevel warn

&lt;IfModule log_config_module&gt;
    #
    # The following directives define some format nicknames for use with
    # a CustomLog directive (see below).
    #
    LogFormat &quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %b \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot;&quot; combined
    LogFormat &quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %b&quot; common

    &lt;IfModule logio_module&gt;
      # You need to enable mod_logio.c to use %I and %O
      LogFormat &quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %b \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot; %I %O&quot; combinedio
    &lt;/IfModule&gt;

    #
    # The location and format of the access logfile (Common Logfile Format).
    # If you do not define any access logfiles within a &lt;VirtualHost&gt;
    # container, they will be logged here.  Contrariwise, if you *do*
    # define per-&lt;VirtualHost&gt; access logfiles, transactions will be
    # logged therein and *not* in this file.
    #
    CustomLog /proc/self/fd/1 common

    #
    # If you prefer a logfile with access, agent, and referer information
    # (Combined Logfile Format) you can use the following directive.
    #
    #CustomLog &quot;logs/access_log&quot; combined
&lt;/IfModule&gt;

&lt;IfModule alias_module&gt;
    #
    # Redirect: Allows you to tell clients about documents that used to 
    # exist in your server's namespace, but do not anymore. The client 
    # will make a new request for the document at its new location.
    # Example:
    # Redirect permanent /foo http://www.example.com/bar

    #
    # Alias: Maps web paths into filesystem paths and is used to
    # access content that does not live under the DocumentRoot.
    # Example:
    # Alias /webpath /full/filesystem/path
    #
    # If you include a trailing / on /webpath then the server will
    # require it to be present in the URL.  You will also likely
    # need to provide a &lt;Directory&gt; section to allow access to
    # the filesystem path.

    #
    # ScriptAlias: This controls which directories contain server scripts. 
    # ScriptAliases are essentially the same as Aliases, except that
    # documents in the target directory are treated as applications and
    # run by the server when requested rather than as documents sent to the
    # client.  The same rules about trailing &quot;/&quot; apply to ScriptAlias
    # directives as to Alias.
    #
    ScriptAlias /cgi-bin/ &quot;/usr/local/apache2/cgi-bin/&quot;

&lt;/IfModule&gt;

&lt;IfModule cgid_module&gt;
    #
    # ScriptSock: On threaded servers, designate the path to the UNIX
    # socket used to communicate with the CGI daemon of mod_cgid.
    #
    #Scriptsock cgisock
&lt;/IfModule&gt;

#
# &quot;/usr/local/apache2/cgi-bin&quot; should be changed to whatever your ScriptAliased
# CGI directory exists, if you have that configured.
#
&lt;Directory &quot;/usr/local/apache2/cgi-bin&quot;&gt;
    AllowOverride None
    Options None
    Require all granted
&lt;/Directory&gt;

&lt;IfModule headers_module&gt;
    #
    # Avoid passing HTTP_PROXY environment to CGI's on this or any proxied
    # backend servers which have lingering &quot;httpoxy&quot; defects.
    # 'Proxy' request header is undefined by the IETF, not listed by IANA
    #
    RequestHeader unset Proxy early
&lt;/IfModule&gt;

&lt;IfModule mime_module&gt;
    #
    # TypesConfig points to the file containing the list of mappings from
    # filename extension to MIME-type.
    #
    TypesConfig conf/mime.types

    #
    # AddType allows you to add to or override the MIME configuration
    # file specified in TypesConfig for specific file types.
    #
    #AddType application/x-gzip .tgz
    #
    # AddEncoding allows you to have certain browsers uncompress
    # information on the fly. Note: Not all browsers support this.
    #
    #AddEncoding x-compress .Z
    #AddEncoding x-gzip .gz .tgz
    #
    # If the AddEncoding directives above are commented-out, then you
    # probably should define those extensions to indicate media types:
    #
    AddType application/x-compress .Z
    AddType application/x-gzip .gz .tgz

    #
    # AddHandler allows you to map certain file extensions to &quot;handlers&quot;:
    # actions unrelated to filetype. These can be either built into the server
    # or added with the Action directive (see below)
    #
    # To use CGI scripts outside of ScriptAliased directories:
    # (You will also need to add &quot;ExecCGI&quot; to the &quot;Options&quot; directive.)
    #
    #AddHandler cgi-script .cgi

    # For type maps (negotiated resources):
    #AddHandler type-map var

    #
    # Filters allow you to process content before it is sent to the client.
    #
    # To parse .shtml files for server-side includes (SSI):
    # (You will also need to add &quot;Includes&quot; to the &quot;Options&quot; directive.)
    #
    #AddType text/html .shtml
    #AddOutputFilter INCLUDES .shtml
&lt;/IfModule&gt;

#
# The mod_mime_magic module allows the server to use various hints from the
# contents of the file itself to determine its type.  The MIMEMagicFile
# directive tells the module where the hint definitions are located.
#
#MIMEMagicFile conf/magic

#
# Customizable error responses come in three flavors:
# 1) plain text 2) local redirects 3) external redirects
#
# Some examples:
#ErrorDocument 500 &quot;The server made a boo boo.&quot;
#ErrorDocument 404 /missing.html
#ErrorDocument 404 &quot;/cgi-bin/missing_handler.pl&quot;
#ErrorDocument 402 http://www.example.com/subscription_info.html
#

#
# MaxRanges: Maximum number of Ranges in a request before
# returning the entire resource, or one of the special
# values 'default', 'none' or 'unlimited'.
# Default setting is to accept 200 Ranges.
#MaxRanges unlimited

#
# EnableMMAP and EnableSendfile: On systems that support it, 
# memory-mapping or the sendfile syscall may be used to deliver
# files.  This usually improves server performance, but must
# be turned off when serving from networked-mounted 
# filesystems or if support for these functions is otherwise
# broken on your system.
# Defaults: EnableMMAP On, EnableSendfile Off
#
#EnableMMAP off
#EnableSendfile on

# Supplemental configuration
#
# The configuration files in the conf/extra/ directory can be 
# included to add extra features or to modify the default configuration of 
# the server, or you may simply copy their contents here and change as 
# necessary.

# Server-pool management (MPM specific)
#Include conf/extra/httpd-mpm.conf

# Multi-language error messages
#Include conf/extra/httpd-multilang-errordoc.conf

# Fancy directory listings
#Include conf/extra/httpd-autoindex.conf

# Language settings
#Include conf/extra/httpd-languages.conf

# User home directories
#Include conf/extra/httpd-userdir.conf

# Real-time info on requests and configuration
#Include conf/extra/httpd-info.conf

# Virtual hosts
#Include conf/extra/httpd-vhosts.conf

# Local access to the Apache HTTP Server Manual
#Include conf/extra/httpd-manual.conf

# Distributed authoring and versioning (WebDAV)
#Include conf/extra/httpd-dav.conf

# Various default settings
#Include conf/extra/httpd-default.conf

# Configure mod_proxy_html to understand HTML4/XHTML1
&lt;IfModule proxy_html_module&gt;
Include conf/extra/proxy-html.conf
&lt;/IfModule&gt;

# Secure (SSL/TLS) connections
#Include conf/extra/httpd-ssl.conf
#
# Note: The following must must be present to support
#       starting without SSL on platforms with no /dev/random equivalent
#       but a statically compiled-in mod_ssl.
#
&lt;IfModule ssl_module&gt;
SSLRandomSeed startup builtin
SSLRandomSeed connect builtin
&lt;/IfModule&gt;
'''


#启动容器
sudo docker run -itd --name httpd-default -p 8234:80 --restart=always -v /home/ubuntu/docker/httpd-default/htdocs:/usr/local/apache2/htdocs -v /home/ubuntu/docker/httpd-default/conf/httpd.conf:/usr/local/apache2/conf/httpd.conf -v /home/ubuntu/docker/httpd-default/logs:/usr/local/apache2/logs httpd
#sudo docker run -itd --name httpd-default -p 8234:80 --restart=always -v /home/ubuntu/docker/httpd-default/htdocs:/usr/local/apache2/htdocs -v /home/ubuntu/docker/httpd-default/conf:/usr/local/apache2/conf -v /home/ubuntu/docker/httpd-default/logs:/usr/local/apache2/logs httpd
</code></pre>
<h5 id="_8">配置命令</h5>
<p>进入容器</p>
<pre><code class="language-shell">sudo docker exec -it httpd-default /bin/bash
</code></pre>
<h6 id="_9">修改中文显示</h6>
<pre><code class="language-shell">#首先更新apt源
apt-get update
#安装文本编辑器vim
apt-get install vim
#切换到conf目录
cd ./conf
#修改httpd.conf配置文件，在末尾添加`IndexOptions Charset=UTF-8`
#先备份
cp ./httpd.conf ./httpd.conf.BAK
vi ./httpd.conf
#按`i`进入编辑模式
#在文件末尾插入以下内容
'
IndexOptions Charset=UTF-8
'
#修改完毕后按ESC退出编辑模式，按`:`，输入`wq`后回车，保存退出
#退出容器
exit
#重启容器生效
sudo docker restart httpd-default
</code></pre>
<h6 id="_10">设置需要密码访问</h6>
<pre><code class="language-shell">#修改Apache的配置文件/usr/local/apache2/conf/httpd.conf，对需要认证的资源所在的目录进行配置
cd ./conf
#修改httpd.conf配置文件，在末尾添加``
#先备份
cp ./httpd.conf ./httpd.conf.BAK
vi ./httpd.conf
#按`i`进入编辑模式，然后修改文件目录对应的&lt;Directory&gt;，此处以`htdocs`根目录为例
#修改Apache的配置文件/usr/local/apache2/conf/httpd.conf，对需要认证的资源所在的目录进行配置
'
&lt;Directory &quot;/usr/local/apache2/htdocs&quot;&gt;  #网站根目录
    Options Indexes MultiViews
    AllowOverride AuthConfig
    Order allow,deny
    Allow from all
&lt;/Directory&gt;
'
#修改完毕后按ESC退出编辑模式，按`:`，输入`wq`后回车，保存退出
#在限制访问目录/usr/local/apache2/htdocs/下创建文件.htaccess，修改文件内容
cd ..
cd ./htdocs
vi .htaccess
#按`i`进入编辑模式，然后修改文件目录对应的&lt;Directory&gt;，此处以`htdocs`根目录为例
'
AuthName &quot;sys&quot;
AuthType Basic
AuthUserFile /usr/local/apache2/htdocs/.htpasswd
require user admin
'
#修改完毕后按ESC退出编辑模式，按`:`，输入`wq`后回车，保存退出
#利用Apache附带的程序htpasswd，生成包含用户名和密码的文本文件：/var/www/html/.htpasswd
htpasswd -c /usr/local/apache2/htdocs/.htpasswd admin

# 若需要添加多个用户，则依次再为每个用户设置密码:
htpasswd -m .htpasswd your_user_name
# htaccess中，添加对应用户名，使用空格分隔
require user admin your_user_name1 your_user_name2

#若使用映射到主机的目录，则为： htpasswd -c /home/ubuntu/docker/httpd-default/htdocs/.htpasswd admin
#输入密码
# 或：/usr/local/apache2/bin/htpasswd -c /usr/local/apache2/htdocs/.htpasswd admin
#退出容器
exit
#重启容器生效
sudo docker restart httpd-default
</code></pre>
<h6 id="404">自定义404等页面</h6>
<p>httpd.conf中：</p>
<pre><code class="language-bash">#
# Customizable error responses come in three flavors:
# 1) plain text 2) local redirects 3) external redirects
#
# Some examples:
#ErrorDocument 500 &quot;The server made a boo boo.&quot;
#ErrorDocument 404 /missing.html
#ErrorDocument 404 &quot;/cgi-bin/missing_handler.pl&quot;
#ErrorDocument 402 http://www.example.com/subscription_info.html
#
</code></pre>
<pre><code class="language-bash">ErrorDocument 400 /error_pages/400.html
ErrorDocument 401 /error_pages/401.html
ErrorDocument 403 /error_pages/403.html
ErrorDocument 404 /error_pages/404.html
ErrorDocument 500 /error_pages/500.html
</code></pre>
<h4 id="navidrome">navidrome自建音乐播放器</h4>
<p>先拉取镜像：</p>
<pre><code class="language-bash">#latest version
sudo docker pull deluan/navidrome:latest


#custom version, e.g.pr-2818
sudo docker pull deluan/navidrome:pr-2818
</code></pre>
<p>创建并运行容器（自定义音乐所在目录和数据目录）：</p>
<pre><code class="language-bash">#latest version
sudo docker run -itd --name navidrome-default -v /mnt/toshiba/docker/httpd-default/htdocs:/music -v /mnt/toshiba/docker/navidrome-default:/data --restart=unless-stopped --user $(id -u):$(id -g) -p 8236:4533 -e ND_LOGLEVEL=info deluan/navidrome:latest


#custom version, e.g.pr-2818
sudo docker run -itd --name navidrome-default -v /mnt/toshiba/docker/httpd-default/htdocs:/music -v /mnt/toshiba/docker/navidrome-default:/data --restart=unless-stopped --user $(id -u):$(id -g) -p 8236:4533 -e ND_LOGLEVEL=info deluan/navidrome:pr-2818
</code></pre>
<h4 id="jellyfin">jellyfin</h4>
<pre><code class="language-bash">sudo mkdir -p /home/ubuntu/docker/jellyfin-default/library
sudo mkdir -p /home/ubuntu/docker/jellyfin-default/tvseries
sudo mkdir -p /home/ubuntu/docker/jellyfin-default/movies

sudo docker run -d --name=jellyfin-default -e PUID=1000 -e PGID=1000 -e TZ=Etc/UTC -p 8096:8096 -p 8920:8920 -p 7359:7359  -p 1900:1900 -v /home/ubuntu/docker/jellyfin-default/library:/config -v /home/ubuntu:/data/tvshows -v /home/ubuntu:/data/movies -v /:/data/root --restart unless-stopped  linuxserver/jellyfin:10.9.10

#sudo docker run -d --name=jellyfin-default -e PUID=1000 -e PGID=1000 -e TZ=Etc/UTC -p 8096:8096 -p 8920:8920 -p 7359:7359  -p 1900:1900 -v /home/ubuntu/docker/jellyfin-default/library:/config -v /home/ubuntu/docker/jellyfin-default/tvseries:/data/tvshows -v /home/ubuntu/docker/jellyfin-default/movies:/data/movies --restart unless-stopped  lscr.io/linuxserver/jellyfin:10.9.10
</code></pre>
<h4 id="kodexplorer">kodexplorer</h4>
<h5 id="1">1.快速启动</h5>
<pre><code class="language-bash">docker run -d -p 80:80 kodcloud/kodexplorer
</code></pre>
<h5 id="2">2.实现数据持久化——创建数据目录并在启动时挂载</h5>
<pre><code class="language-bash">mkdir /data
docker run -d -p 80:80 -v /data:/var/www/html kodcloud/kodexplorer
</code></pre>
<p>thinServer的部署代码：</p>
<pre><code class="language-bash">cd /mnt/toshiba
mkdir kodexplorer-default

sudo docker pull kodcloud/kodexplorer:4.52

sudo docker run -itd --name kodexplorer-default --restart=always -v /mnt/toshiba/docker/kodexplorer-default:/var/www/html -p 8237:80 kodcloud/kodexplorer:4.52
</code></pre>
<h5 id="3">3.禁止更新：</h5>
<p>https://www.jianshu.com/p/65961c08b73d</p>
<p>去更新操作</p>
<ul>
<li>进入你的KodExplorer的根目录, 并找到版本号文件
  KodTest文件夹是我的根目录, 所以我的版本号文件在 <code>KodTest/config/version.php</code></li>
<li>打开version.php, 将其中的版本号改为<code>100.520</code> 并保存. (这个只要是大于官网最新版本就行)
  [图片上传失败...(image-14b990-1590122980697)]</li>
<li>之后, 进入你的KodExplorer, 这时已经不再提醒更新了.</li>
</ul>
<hr />
<p>版权信息修改</p>
<ul>
<li>版权信息文件位于<code>KodTest/config/i18n/zh-CN/main.php</code>目录下, 相关代码在288行左右. 建议没有基础的小白不要自行修改. (KodExplorer的新版本的版权信息位置可能会更改)</li>
<li>注意: 修改版权信息字样是, 登录会弹出窗口提醒版权信息已修改. 这个弹窗的文件和代码位置目前我还没找到. 所以解决办法可以使不去除版权字样, 但在版权字样前加自己想要的文字, 之后多打几个空格, 这样版权字样没被去除但是版权字样也不会出现. (因为被空格挤出了屏幕)</li>
</ul>
<h4 id="nextcloud">nextcloud部署</h4>
<h5 id="_11">部署命令</h5>
<p>拉取镜像</p>
<pre><code class="language-shell">sudo docker pull nextcloud
</code></pre>
<p>创建对应的mysql5.7容器，并配置数据库、创建管理员账户</p>
<pre><code class="language-shell">#拉取mysql5.7镜像
sudo docker pull mysql:5.7
#运行mysql5.7镜像
sudo docker run --name=mysql5-default -e MYSQL_ROOT_PASSWORD=123456 -d -p 3306:3306 --restart=always mysql:5.7
#创建nextcloud_db数据库
sudo docker exec -it mysql5-default mysql -u root -p
</code></pre>
<pre><code class="language-sql">CREATE DATABASE nextcloud;
GRANT ALL ON *.* TO 'root'@'%';
flush privileges;
exit;
</code></pre>
<p>运行</p>
<pre><code class="language-shell">#创建映射目录
sudo mkdir -p /home/ubuntu/docker/nextcloud-default/nextcloud/html
#启动容器
sudo docker run -itd --restart always --name nextcloud-default --link mysql5-default:db -p 8235:80 -v /home/ubuntu/docker/nextcloud-default/nextcloud/html:/var/www/html nextcloud
</code></pre>
<p>运行后，配置时数据库名可任意（最好写和上述匹配的mysql5-default），主机名称和端口号写db。</p>
<h5 id="nextcloud-0770"><strong>错误：nextcloud 您的数据目录可被其他用户读取 请更改权限为 0770 以避免其他用户查看目录</strong></h5>
<p>解决办法：config.php 添加 ‘check_data_directory_permissions’ =&gt; false</p>
<pre><code class="language-php">'check_data_directory_permissions' =&gt; false
</code></pre>
<h5 id="nextcloud-ipip">Nextcloud 通过不被信任的域名访问 动态IP解决方案，允许所有IP访问</h5>
<p>解决方法：</p>
<p>打开 /config/config.php</p>
<p>找到 trusted_domains</p>
<p>增加一项</p>
<p><code>preg_match('/cli/i',php_sapi_name())?'127.0.0.1':$_SERVER['SERVER_NAME']</code></p>
<p>完整的代码</p>
<pre><code class="language-php">//索引数字顺延就可以
'trusted_domains' =&gt; array(
        0 =&gt; '127.0.0.1',
        1 =&gt; preg_match('/cli/i',php_sapi_name())?'127.0.0.1':$_SERVER['SERVER_NAME'],
),
</code></pre>
<p>解释：$_SERVER[‘SERVER_NAME’] 为获得当前访问的域名或IP，最初只设置了server_name，后来在查看cron任务时，发现在cli模式下是无法获得的，所以增加了cli模式判断，cli模式直接给个本地IP忽悠程序，正常模式将当前访问的域名或IP动态的添加的信任的域名中。</p>
<h4 id="onlyoffice">onlyoffice部署</h4>
<h5 id="_12">部署命令</h5>
<p>拉取镜像</p>
<pre><code class="language-shell">sudo docker pull onlyoffice/documentserver
</code></pre>
<p>运行</p>
<pre><code class="language-shell">#创建映射目录
sudo mkdir -p /home/ubuntu/docker/onlyoffice-default/log
sudo mkdir -p /home/ubuntu/docker/onlyoffice-default/data
sudo mkdir -p /home/ubuntu/docker/onlyoffice-default/lib
sudo mkdir -p /home/ubuntu/docker/onlyoffice-default/db
#启动容器
sudo docker run -i -t -d -p 8236:80 --name onlyoffice-default --restart=always -v /home/ubuntu/docker/onlyoffice-default/log:/var/log/onlyoffice -v /home/ubuntu/docker/onlyoffice-default/data:/var/www/onlyoffice/Data -v /home/ubuntu/docker/onlyoffice-default/lib:/var/lib/onlyoffice -v /home/ubuntu/docker/onlyoffice-default/db:/var/lib/postgresql  onlyoffice/documentserver
</code></pre>
<h5 id="_13">配置命令</h5>
<pre><code class="language-shell">sudo docker exec -it onlyoffice-default /bin/bash
</code></pre>
<h5 id="nextcloudonlyoffice">nextcloud与onlyoffice链接</h5>
<p>在应用中下载onlyoffice，如果显示链接超时错误，进入目录/home/<a href="https://so.csdn.net/so/search?q=docker&amp;spm=1001.2101.3001.7020">docker</a>/nextcloud/config，打开config.php文件，在末尾加入内容：</p>
<pre><code class="language-php">'appstoreenabled' =&gt; true,
'appstoreurl' =&gt; 'https://www.orcy.net/ncapps/v1/',
</code></pre>
<p>在nextcloud的设置中找到ONLYOFFICE，修改相应设置。</p>
<p>如果显示无法连接，则在config.php末尾加上：</p>
<pre><code class="language-php">'allow_local_remote_servers' =&gt; true,
</code></pre>
<h4 id="jupyterbase-notebook">jupyter/base-notebook配置</h4>
<h5 id="_14">镜像拉取</h5>
<pre><code class="language-bash">sudo docker pull jupyter/base-notebook
</code></pre>
<h5 id="_15">创建容器</h5>
<p>首先创建一个测试容器，用于生成jupyter-notebook的登陆密码：</p>
<pre><code class="language-bash">#在启动时携带--rm选项表示退出容器时会自动将其删除
sudo docker run --rm -p 8765:8888 jupyter/base-notebook
#在启动时携带--rm选项表示退出容器时会自动将其删除
</code></pre>
<p>设置密码：</p>
<pre><code class="language-python">from notebook.auth import passwd
passwd()
#输入密码，输入确认密码后，生成序列
</code></pre>
<p>此处使用了--rm参数，退出容器时会自动将其删除。</p>
<p>然后修改NotebookApp.password为上一步生成的序列，先创建对应工作目录并设置目录权限，然后创建容器：</p>
<pre><code class="language-bash">sudo mkdir -p /home/ubuntu/docker/jupyter-base-notebook-default
sudo chown ubuntu /home/ubuntu/docker/jupyter-base-notebook-default
sudo chmod 777 /home/ubuntu/docker/jupyter-base-notebook-default/
sudo docker run -itd --user root -p 9003:8888 -v /home/ubuntu/docker/jupyter-base-notebook-default:/home/jovyan/work --name jupyter-base-notebook-default jupyter/base-notebook start-notebook.sh --NotebookApp.password='argon2:$argon2id$v=19$m=10240,t=10,p=8$jrgM8WxzlfpOvvvsMnSikg$cZWW4J5Vxan2cUDvkguw4ZWQ7rnnTqPqKVR9XEEeoSY' --NotebookApp.allow_password_change=False --NotebookApp.allow_remote_access=True --NotebookApp.open_browser=False --NotebookApp.notebook_dir=&quot;/home/jovyan/work&quot;
#此命令中密码为abcd1234
</code></pre>
<p>以下是映射到端口8765，默认密码a0b0c1d2：</p>
<pre><code class="language-bash">sudo mkdir -p /home/ubuntu/docker/jupyter-base-notebook-default
sudo chown ubuntu /home/ubuntu/docker/jupyter-base-notebook-default
sudo chmod 777 /home/ubuntu/docker/jupyter-base-notebook-default/
sudo docker run -itd --user root -p 8765:8888 -v /home/ubuntu/docker/jupyter-base-notebook-default:/home/jovyan/work --name jupyter-base-notebook-default jupyter/base-notebook start-notebook.sh --NotebookApp.password='argon2:$argon2id$v=19$m=10240,t=10,p=8$5yg+H3DM01xG9iGx0fmAdw$0nxMo9IEY9z0WSf/hNcjdpDOwRQhZcAdq/UymeSzJOA' --NotebookApp.allow_password_change=False --NotebookApp.allow_remote_access=True --NotebookApp.open_browser=False --NotebookApp.notebook_dir=&quot;/home/jovyan/work&quot;
</code></pre>
<h5 id="_16">修改中文</h5>
<p>若需修改语言为中文，请使用pip安装此包，然后在Settings-Language中切换语言为中文即可：</p>
<pre><code class="language-bash">pip install jupyterlab-language-pack-zh-CN
</code></pre>
<h4 id="rtmp">rtmp</h4>
<pre><code class="language-bash">sudo docker pull alqutami/rtmp-hls
sudo docker run -d -p 11935:1935 -p 18080:8080 alqutami/rtmp-hls
</code></pre>
<h6 id="to-stream-to-the-server">To stream to the server</h6>
<ul>
<li><strong>Stream live RTMP content to:</strong></li>
</ul>
<p><code>rtmp://&lt;server ip&gt;:1935/live/&lt;stream_key&gt;</code></p>
<p>where <code>&lt;stream_key&gt;</code> is any stream key you specify.</p>
<ul>
<li>
<p><strong>Configure <a href="https://obsproject.com/">OBS</a> to stream content:</strong>
  Go to Settings &gt; Stream, choose the following settings:</p>
</li>
<li>
<p>Service: Custom Streaming Server.</p>
</li>
<li>Server: <code>rtmp://&lt;server ip&gt;:1935/live</code>.</li>
<li>Stream key: anything you want, however provided video players assume stream key is <code>test</code></li>
</ul>
<h4 id="calibre-web">calibre-web部署</h4>
<p>初次启动时的 <a href="./File/metadata.db">metadata.db</a> 在File目录中。</p>
<pre><code class="language-bash">sudo docker pull linuxserver/calibre-web:0.6.21
</code></pre>
<h6 id="user-group-identifiers">User / Group Identifiers</h6>
<p><strong>注：必须使用正确的id，否则会导致目录无读写权限</strong></p>
<p>When using volumes (<code>-v</code> flags), permissions issues can arise between the host OS and the container, we avoid this issue by allowing you to specify the user <code>PUID</code> and group <code>PGID</code>.</p>
<p>Ensure any volume directories on the host are owned by the same user you specify and any permissions issues will vanish like magic.</p>
<p>In this instance <code>PUID=1000</code> and <code>PGID=1000</code>, to find yours use <code>id your_user</code> as below:</p>
<pre><code class="language-bash">id your_user
</code></pre>
<p>Example output:</p>
<pre><code class="language-text">uid=1000(your_user) gid=1000(your_user) groups=1000(your_user)
</code></pre>
<p><strong>docker-compose (recommended, <a href="https://docs.linuxserver.io/general/docker-compose">click here for more info</a>)</strong></p>
<pre><code class="language-yaml">---
services:
  calibre-web:
    image: lscr.io/linuxserver/calibre-web:latest
    container_name: calibre-web
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Etc/UTC
      - DOCKER_MODS=linuxserver/mods:universal-calibre #optional
      - OAUTHLIB_RELAX_TOKEN_SCOPE=1 #optional
    volumes:
      - /path/to/data:/config
      - /path/to/calibre/library:/books
    ports:
      - 8083:8083
    restart: unless-stopped
</code></pre>
<p><strong>docker cli (<a href="https://docs.docker.com/engine/reference/commandline/cli/">click here for more info</a>)</strong></p>
<pre><code class="language-bash">sudo mkdir -p /mnt/toshiba/docker/calibre-web-default/data
sudo mkdir -p /mnt/toshiba/docker/calibre-web-default/library
sudo docker run -d --name=calibre-web-default -e PUID=1000 -e PGID=1000 -e TZ=Etc/UTC -e DOCKER_MODS=linuxserver/mods:universal-calibre `#optional` -e OAUTHLIB_RELAX_TOKEN_SCOPE=1 `#optional` -p 8239:8083 -v /mnt/toshiba/docker/calibre-web-default/data:/config -v /mnt/toshiba/docker/calibre-web-default/library:/books --restart unless-stopped linuxserver/calibre-web:0.6.21
</code></pre>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Function</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-p 8083</code></td>
<td>WebUI</td>
</tr>
<tr>
<td><code>-e PUID=1000</code></td>
<td>for UserID - see below for explanation</td>
</tr>
<tr>
<td><code>-e PGID=1000</code></td>
<td>for GroupID - see below for explanation</td>
</tr>
<tr>
<td><code>-e TZ=Etc/UTC</code></td>
<td>specify a timezone to use, see this <a href="https://en.wikipedia.org/wiki/List_of_tz_database_time_zones#List">list</a>.</td>
</tr>
<tr>
<td><code>-e DOCKER_MODS=linuxserver/mods:universal-calibre</code></td>
<td>#optional &amp; <strong>x86-64 only</strong> Adds the ability to perform ebook conversion</td>
</tr>
<tr>
<td><code>-e OAUTHLIB_RELAX_TOKEN_SCOPE=1</code></td>
<td>Optionally set this to allow Google OAUTH to work</td>
</tr>
<tr>
<td><code>-v /config</code></td>
<td>Where calibre-web stores the internal database and config.</td>
</tr>
<tr>
<td><code>-v /books</code></td>
<td>Where your preexisting calibre database is located.</td>
</tr>
</tbody>
</table>
<p><strong>Environment variables from files (Docker secrets)</strong></p>
<p>You can set any environment variable from a file by using a special prepend <code>FILE__</code>.</p>
<p>As an example:</p>
<pre><code class="language-bash">-e FILE__MYVAR=/run/secrets/mysecretvariable
</code></pre>
<p>Will set the environment variable <code>MYVAR</code> based on the contents of the <code>/run/secrets/mysecretvariable</code> file.</p>
<h4 id="teamspeak">teamspeak部署</h4>
<pre><code class="language-bash">sudo docker run -p 9987:9987/udp -p 10011:10011 -p 10022:10022 -p 10080:10080 -p 10443:10443 -p 30033:30033 -p 41144:41144 -e TS3SERVER_LICENSE=accept --name teamspeak-default -d teamspeak
</code></pre>
<p>然后查看token，使用teamspeak client登陆</p>
<pre><code class="language-bash">sudo docker logs teamspeak-default
</code></pre>
<h4 id="kmswindoowsoffice">kms服务器部署及windoows+office激活</h4>
<p>有两个kms服务器镜像，二选一部署即可：</p>
<h5 id="_17">服务器部署</h5>
<h6 id="amogekovlmcsd">镜像A：mogeko/vlmcsd</h6>
<pre><code class="language-bash">sudo docker pull mogeko/vlmcsd
sudo docker run -d --name vlmcsd-default -p 1688:1688 --restart always mogeko/vlmcsd
</code></pre>
<h6 id="bluodaoyikms-server">镜像B：luodaoyi/kms-server</h6>
<pre><code class="language-bash">sudo docker pull luodaoyi/kms-server
sudo docker run -d --name kms-server-default -p 1688:1688 --restart always luodaoyi/kms-server
</code></pre>
<h5 id="_18"></h5>
<h4 id="docker-compose-sparkhadoop">docker-compose spark+hadoop部署</h4>
<h5 id="_19">部署命令</h5>
<p>首先拉取singularities/spark:2.2镜像。</p>
<pre><code class="language-bash">sudo docker pull singularities/spark
</code></pre>
<p>创建工作目录，创建并修改docker-compose.yml。</p>
<pre><code class="language-bash">sudo mkdir singularitiesCR
sudo touch docker-compose.yml
sudo vi docker-compose.yml
</code></pre>
<p>docker-compose.yml文件的内容如下，注意需要修改data目录与本机实际的data目录匹配。可以自行修改端口映射。</p>
<pre><code class="language-yaml">version: &quot;2&quot;

services:
  master:
    image: singularities/spark
    command: start-spark master
    hostname: master
    ports:
      - &quot;6066:6066&quot;
      - &quot;7070:7070&quot;
      - &quot;8080:8080&quot;
      - &quot;50070:50070&quot;
  worker:
    image: singularities/spark
    command: start-spark worker master
    environment:
      SPARK_WORKER_CORES: 1
      SPARK_WORKER_MEMORY: 2g
    links:
      - master
    volumes:
      # 设置本地目录和镜像目录的映射关系（格式：本地机器目录:镜像中对应路径）
      - /home/ubuntu/docker/spark-demo/singularitiesCR/data:/input_files
</code></pre>
<p>运行容器、查看容器状态、停止容器、删除容器</p>
<pre><code class="language-bash">sudo docker-compose up -d
sudo docker-compose ps
sudo docker-compose stop
sudo docker-compose rm
</code></pre>
<p>后台页面对应地址如下：</p>
<pre><code class="language-yaml"># Hadoop管理页面
127.0.0.1:50070
# Spark任务管理页面
127.0.0.1:8080
</code></pre>
<h4 id="docker-composesparkhadoop">docker-compose搭建spark+hadoop集群</h4>
<h5 id="1dockerdocker-compose">1、安装docker和docker-Compose</h5>
<p><strong>(不推荐使用这里的步骤，请参阅最顶部的docker和docker-compose安装教程)</strong></p>
<h6 id="11docker">1.1、安装docker</h6>
<p>(如果机器中已经安装过docker，可以直接跳过)</p>
<p>关闭防火墙</p>
<pre><code class="language-bash">sudo systemctl stop firewalld
sudo systemctl disable firewalld
sudo systemctl status firewalld
</code></pre>
<p>设置SELinux成为permissive模式（临时关闭SELinux）</p>
<pre><code class="language-bash">sudo setenforce 0
sudo getenforce
</code></pre>
<p>更换yum源为阿里源加速</p>
<pre><code class="language-bash">sudo yum -y update
sudo mkdir /etc/yum.repos.d/oldrepo
sudo mv /etc/yum.repos.d/*.repo /etc/yum.repos.d/oldrepo/
sudo wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo
sudo yum install -y yum-utils device-mapper-persistent-data lvm2
sudo yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo
sudo yum clean all
sudo yum makecache fast
</code></pre>
<p>安装docker</p>
<pre><code class="language-bash">sudo yum list docker-ce --showduplicates | sort -r
sudo yum -y install docker-ce
sudo systemctl start docker
sudo systemctl enable docker
sudo ps -ef | grep docker
sudo docker version
</code></pre>
<p>到这一步能正常输出docker版本，说明docker已经成功安装。</p>
<p>为了后续拉取镜像能更快，需要添加一个镜像：</p>
<pre><code class="language-bash">sudo vi /etc/docker/daemon.json
</code></pre>
<p>添加以下内容，保存退出</p>
<pre><code class="language-json"> {
  &quot;registry-mirrors&quot;: [&quot;https://x3n9jrcg.mirror.aliyuncs.com&quot;]
 }
</code></pre>
<p>重启docker</p>
<pre><code class="language-bash">sudo systemctl daemon-reload
sudo systemctl restart docker
</code></pre>
<p>后面需要用git拉取一些资源，所以要安装git，为了能够正常访问github，需要修改一下hosts文件</p>
<pre><code class="language-bash">sudo yum -y install git
sudo sudo vi /etc/hosts
</code></pre>
<p>添加以下内容：</p>
<pre><code>192.30.255.112  github.com git
</code></pre>
<h6 id="12docker-compose">1.2、安装docker-Compose</h6>
<p>(如果已经安装过docker-compose，可以直接跳过)</p>
<pre><code class="language-bash">sudo curl -L https://get.daocloud.io/docker/compose/releases/download/1.27.4/docker-compose-`uname -s`-`uname -m` &gt; /usr/local/bin/docker-compose
sudo chmod +x /usr/local/bin/docker-compose
sudo docker-compose --version
</code></pre>
<p>能够正常输出docker-compose版本号，说明成功安装。</p>
<h5 id="2sparkhdfs">2、极速搭建Spark集群（含HDFS集群）</h5>
<p>先创建一个文件夹用来存放配置文件，集群的安装路径也会是这个文件夹，所以想好放在哪里比较好，我的路径是：/home/ubuntu/docker/sparkcluster_hdfs/</p>
<h6 id="21hadoopenv">2.1、编辑hadoop.env配置文件</h6>
<p>进入你创建的目录编辑hadoop.env配置文件，我这里是/home/sparkcluster_hdfs目录：</p>
<pre><code class="language-bash">sudo mkdir -p /home/ubuntu/docker/sparkcluster_hdfs/
cd /home/ubuntu/docker/sparkcluster_hdfs/
sudo touch hadoop.env
sudo vi hadoop.env
</code></pre>
<p>复制以下内容进去保存</p>
<pre><code class="language-env">CORE_CONF_fs_defaultFS=hdfs://namenode:8020
CORE_CONF_hadoop_http_staticuser_user=root
CORE_CONF_hadoop_proxyuser_hue_hosts=*
CORE_CONF_hadoop_proxyuser_hue_groups=*

HDFS_CONF_dfs_webhdfs_enabled=true
HDFS_CONF_dfs_permissions_enabled=false

YARN_CONF_yarn_log___aggregation___enable=true
YARN_CONF_yarn_resourcemanager_recovery_enabled=true
YARN_CONF_yarn_resourcemanager_store_class=org.apache.hadoop.yarn.server.resourcemanager.recovery.FileSystemRMStateStore
YARN_CONF_yarn_resourcemanager_fs_state___store_uri=/rmstate
YARN_CONF_yarn_nodemanager_remote___app___log___dir=/app-logs
YARN_CONF_yarn_log_server_url=http://historyserver:8188/applicationhistory/logs/
YARN_CONF_yarn_timeline___service_enabled=true
YARN_CONF_yarn_timeline___service_generic___application___history_enabled=true
YARN_CONF_yarn_resourcemanager_system___metrics___publisher_enabled=true
YARN_CONF_yarn_resourcemanager_hostname=resourcemanager
YARN_CONF_yarn_timeline___service_hostname=historyserver
YARN_CONF_yarn_resourcemanager_address=resourcemanager:8032
YARN_CONF_yarn_resourcemanager_scheduler_address=resourcemanager:8030
YARN_CONF_yarn_resourcemanager_resource___tracker_address=resourcemanager:8031
</code></pre>
<h6 id="22docker-composeyml">2.2、编辑docker-compose.yml编排配置文件</h6>
<p>还是在/home/sparkcluster_hdfs目录编辑docker-compose.yml编排配置文件：</p>
<pre><code class="language-bash">cd /home/ubuntu/docker/sparkcluster_hdfs/
sudo touch docker-compose.yml
sudo vi docker-compose.yml
</code></pre>
<p>复制以下内容进去保存
注意：spark的worker数量，以及worker内存的分配，都可以通过修改docker-compose.yml文件来调整。</p>
<h6 id="13datanode6workeryml">1、此为（3datanode+6worker）的yml文件示例</h6>
<pre><code class="language-yaml">version: &quot;2.2&quot;
services:
  namenode:
    image: bde2020/hadoop-namenode:1.1.0-hadoop2.7.1-java8
    container_name: namenode
    volumes:
      - ./hadoop/namenode:/hadoop/dfs/name
      - ./input_files:/input_files
    environment:
      - CLUSTER_NAME=test
    env_file:
      - ./hadoop.env
    ports:
      - 50070:50070

  resourcemanager:
    image: bde2020/hadoop-resourcemanager:1.1.0-hadoop2.7.1-java8
    container_name: resourcemanager
    depends_on:
      - namenode
      - datanode1
      - datanode2
    env_file:
      - ./hadoop.env

  historyserver:
    image: bde2020/hadoop-historyserver:1.1.0-hadoop2.7.1-java8
    container_name: historyserver
    depends_on:
      - namenode
      - datanode1
      - datanode2
    volumes:
      - ./hadoop/historyserver:/hadoop/yarn/timeline
    env_file:
      - ./hadoop.env

  nodemanager1:
    image: bde2020/hadoop-nodemanager:1.1.0-hadoop2.7.1-java8
    container_name: nodemanager1
    depends_on:
      - namenode
      - datanode1
      - datanode2
    env_file:
      - ./hadoop.env

  datanode1:
    image: bde2020/hadoop-datanode:1.1.0-hadoop2.7.1-java8
    container_name: datanode1
    depends_on:
      - namenode
    volumes:
      - ./hadoop/datanode1:/hadoop/dfs/data
    env_file:
      - ./hadoop.env

  datanode2:
    image: bde2020/hadoop-datanode:1.1.0-hadoop2.7.1-java8
    container_name: datanode2
    depends_on:
      - namenode
    volumes:
      - ./hadoop/datanode2:/hadoop/dfs/data
    env_file:
      - ./hadoop.env

  datanode3:
    image: bde2020/hadoop-datanode:1.1.0-hadoop2.7.1-java8
    container_name: datanode3
    depends_on:
      - namenode
    volumes:
      - ./hadoop/datanode3:/hadoop/dfs/data
    env_file:
      - ./hadoop.env

  master:
    image: gettyimages/spark:2.3.0-hadoop-2.8
    container_name: master
    command: bin/spark-class org.apache.spark.deploy.master.Master -h master
    hostname: master
    environment:
      MASTER: spark://master:7077
      SPARK_CONF_DIR: /conf
      SPARK_PUBLIC_DNS: localhost
    links:
      - namenode
    expose:
      - 4040
      - 7001
      - 7002
      - 7003
      - 7004
      - 7005
      - 7077
      - 6066
    ports:
      - 4040:4040
      - 6066:6066
      - 7077:7077
      - 8080:8080
    volumes:
      - ./conf/master:/conf
      - ./data:/tmp/data
      - ./jars:/root/jars

  worker1:
    image: gettyimages/spark:2.3.0-hadoop-2.8
    container_name: worker1
    command: bin/spark-class org.apache.spark.deploy.worker.Worker spark://master:7077
    hostname: worker1
    environment:
      SPARK_CONF_DIR: /conf
      SPARK_WORKER_CORES: 1
      SPARK_WORKER_MEMORY: 1g
      SPARK_WORKER_PORT: 8881
      SPARK_WORKER_WEBUI_PORT: 8081
      SPARK_PUBLIC_DNS: localhost
    links:
      - master
    expose:
      - 7012
      - 7013
      - 7014
      - 7015
      - 8881
      - 8081
    ports:
      - 8081:8081
    volumes:
      - ./conf/worker1:/conf
      - ./data/worker1:/tmp/data

  worker2:
    image: gettyimages/spark:2.3.0-hadoop-2.8
    container_name: worker2
    command: bin/spark-class org.apache.spark.deploy.worker.Worker spark://master:7077
    hostname: worker2
    environment:
      SPARK_CONF_DIR: /conf
      SPARK_WORKER_CORES: 1
      SPARK_WORKER_MEMORY: 1g
      SPARK_WORKER_PORT: 8881
      SPARK_WORKER_WEBUI_PORT: 8082
      SPARK_PUBLIC_DNS: localhost
    links:
      - master
    expose:
      - 7012
      - 7013
      - 7014
      - 7015
      - 8881
      - 8082
    ports:
      - 8082:8082
    volumes:
      - ./conf/worker2:/conf
      - ./data/worker2:/tmp/data     

  worker3:
    image: gettyimages/spark:2.3.0-hadoop-2.8
    container_name: worker3
    command: bin/spark-class org.apache.spark.deploy.worker.Worker spark://master:7077
    hostname: worker3
    environment:
      SPARK_CONF_DIR: /conf
      SPARK_WORKER_CORES: 1
      SPARK_WORKER_MEMORY: 1g
      SPARK_WORKER_PORT: 8881
      SPARK_WORKER_WEBUI_PORT: 8083
      SPARK_PUBLIC_DNS: localhost
    links:
      - master
    expose:
      - 7012
      - 7013
      - 7014
      - 7015
      - 8881
      - 8083
    ports:
      - 8083:8083
    volumes:
      - ./conf/worker3:/conf
      - ./data/worker3:/tmp/data

  worker4:
    image: gettyimages/spark:2.3.0-hadoop-2.8
    container_name: worker4
    command: bin/spark-class org.apache.spark.deploy.worker.Worker spark://master:7077
    hostname: worker4
    environment:
      SPARK_CONF_DIR: /conf
      SPARK_WORKER_CORES: 1
      SPARK_WORKER_MEMORY: 1g
      SPARK_WORKER_PORT: 8881
      SPARK_WORKER_WEBUI_PORT: 8084
      SPARK_PUBLIC_DNS: localhost
    links:
      - master
    expose:
      - 7012
      - 7013
      - 7014
      - 7015
      - 8881
      - 8084
    ports:
      - 8084:8084
    volumes:
      - ./conf/worker4:/conf
      - ./data/worker4:/tmp/data

  worker5:
    image: gettyimages/spark:2.3.0-hadoop-2.8
    container_name: worker5
    command: bin/spark-class org.apache.spark.deploy.worker.Worker spark://master:7077
    hostname: worker5
    environment:
      SPARK_CONF_DIR: /conf
      SPARK_WORKER_CORES: 1
      SPARK_WORKER_MEMORY: 1g
      SPARK_WORKER_PORT: 8881
      SPARK_WORKER_WEBUI_PORT: 8085
      SPARK_PUBLIC_DNS: localhost
    links:
      - master
    expose:
      - 7012
      - 7013
      - 7014
      - 7015
      - 8881
      - 8085
    ports:
      - 8085:8085
    volumes:
      - ./conf/worker5:/conf
      - ./data/worker5:/tmp/data

  worker6:
    image: gettyimages/spark:2.3.0-hadoop-2.8
    container_name: worker6
    command: bin/spark-class org.apache.spark.deploy.worker.Worker spark://master:7077
    hostname: worker6
    environment:
      SPARK_CONF_DIR: /conf
      SPARK_WORKER_CORES: 1
      SPARK_WORKER_MEMORY: 1g
      SPARK_WORKER_PORT: 8881
      SPARK_WORKER_WEBUI_PORT: 8086
      SPARK_PUBLIC_DNS: localhost
    links:
      - master
    expose:
      - 7012
      - 7013
      - 7014
      - 7015
      - 8881
      - 8086
    ports:
      - 8086:8086
    volumes:
      - ./conf/worker6:/conf
      - ./data/worker6:/tmp/data
</code></pre>
<h6 id="22datanode3workeryml">2、此为（2datanode+3worker）的yml文件示例</h6>
<pre><code class="language-yml">version: &quot;2.2&quot;
services:
  namenode:
    image: bde2020/hadoop-namenode:1.1.0-hadoop2.7.1-java8
    container_name: namenode
    volumes:
      - ./hadoop/namenode:/hadoop/dfs/name
      - ./input_files:/input_files
    environment:
      - CLUSTER_NAME=test
    env_file:
      - ./hadoop.env
    ports:
      - 50070:50070

  resourcemanager:
    image: bde2020/hadoop-resourcemanager:1.1.0-hadoop2.7.1-java8
    container_name: resourcemanager
    depends_on:
      - namenode
      - datanode1
      - datanode2
    env_file:
      - ./hadoop.env

  historyserver:
    image: bde2020/hadoop-historyserver:1.1.0-hadoop2.7.1-java8
    container_name: historyserver
    depends_on:
      - namenode
      - datanode1
      - datanode2
    volumes:
      - ./hadoop/historyserver:/hadoop/yarn/timeline
    env_file:
      - ./hadoop.env

  nodemanager1:
    image: bde2020/hadoop-nodemanager:1.1.0-hadoop2.7.1-java8
    container_name: nodemanager1
    depends_on:
      - namenode
      - datanode1
      - datanode2
    env_file:
      - ./hadoop.env

  datanode1:
    image: bde2020/hadoop-datanode:1.1.0-hadoop2.7.1-java8
    container_name: datanode1
    depends_on:
      - namenode
    volumes:
      - ./hadoop/datanode1:/hadoop/dfs/data
    env_file:
      - ./hadoop.env

  datanode2:
    image: bde2020/hadoop-datanode:1.1.0-hadoop2.7.1-java8
    container_name: datanode2
    depends_on:
      - namenode
    volumes:
      - ./hadoop/datanode2:/hadoop/dfs/data
    env_file:
      - ./hadoop.env

  master:
    image: gettyimages/spark:2.3.0-hadoop-2.8
    container_name: master
    command: bin/spark-class org.apache.spark.deploy.master.Master -h master
    hostname: master
    environment:
      MASTER: spark://master:7077
      SPARK_CONF_DIR: /conf
      SPARK_PUBLIC_DNS: localhost
    links:
      - namenode
    expose:
      - 4040
      - 7001
      - 7002
      - 7003
      - 7004
      - 7005
      - 7077
      - 6066
    ports:
      - 4040:4040
      - 6066:6066
      - 7077:7077
      - 8080:8080
    volumes:
      - ./conf/master:/conf
      - ./data:/tmp/data
      - ./jars:/root/jars

  worker1:
    image: gettyimages/spark:2.3.0-hadoop-2.8
    container_name: worker1
    command: bin/spark-class org.apache.spark.deploy.worker.Worker spark://master:7077
    hostname: worker1
    environment:
      SPARK_CONF_DIR: /conf
      SPARK_WORKER_CORES: 1
      SPARK_WORKER_MEMORY: 1g
      SPARK_WORKER_PORT: 8881
      SPARK_WORKER_WEBUI_PORT: 8081
      SPARK_PUBLIC_DNS: localhost
    links:
      - master
    expose:
      - 7012
      - 7013
      - 7014
      - 7015
      - 8881
      - 8081
    ports:
      - 8081:8081
    volumes:
      - ./conf/worker1:/conf
      - ./data/worker1:/tmp/data

  worker2:
    image: gettyimages/spark:2.3.0-hadoop-2.8
    container_name: worker2
    command: bin/spark-class org.apache.spark.deploy.worker.Worker spark://master:7077
    hostname: worker2
    environment:
      SPARK_CONF_DIR: /conf
      SPARK_WORKER_CORES: 1
      SPARK_WORKER_MEMORY: 1g
      SPARK_WORKER_PORT: 8881
      SPARK_WORKER_WEBUI_PORT: 8082
      SPARK_PUBLIC_DNS: localhost
    links:
      - master
    expose:
      - 7012
      - 7013
      - 7014
      - 7015
      - 8881
      - 8082
    ports:
      - 8082:8082
    volumes:
      - ./conf/worker2:/conf
      - ./data/worker2:/tmp/data     

  worker3:
    image: gettyimages/spark:2.3.0-hadoop-2.8
    container_name: worker3
    command: bin/spark-class org.apache.spark.deploy.worker.Worker spark://master:7077
    hostname: worker3
    environment:
      SPARK_CONF_DIR: /conf
      SPARK_WORKER_CORES: 1
      SPARK_WORKER_MEMORY: 1g
      SPARK_WORKER_PORT: 8881
      SPARK_WORKER_WEBUI_PORT: 8083
      SPARK_PUBLIC_DNS: localhost
    links:
      - master
    expose:
      - 7012
      - 7013
      - 7014
      - 7015
      - 8881
      - 8083
    ports:
      - 8083:8083
    volumes:
      - ./conf/worker3:/conf
      - ./data/worker3:/tmp/data

</code></pre>
<h6 id="23docker-compose">2.3、执行docker-compose命令，一键搭建集群</h6>
<p>还是在/home/sparkcluster_hdfs目录下，执行命令：</p>
<pre><code class="language-bash">sudo docker-compose up -d
</code></pre>
<p>接下来静候命令执行完成，整个spark和hdfs集群环境就搭建好了。</p>
<h6 id="24">2.4、查看集群环境</h6>
<p>在/home/sparkcluster_hdfs目录查看容器情况：</p>
<pre><code class="language-bash">sudo docker-compose ps
</code></pre>
<p>用浏览器查看hdfs，如下图，可见有三个DataNode
地址是：http://centos机器的ip:50070，e.g.: 127.0.0.1:50070</p>
<p><img alt="2" src="../img/2.png" /></p>
<p>浏览器查看spark，如下图，可见有六个worker
地址是：http://centos机器的ip:8080，e.g.: 127.0.0.1:8080</p>
<p><img alt="3" src="../img/3.png" /></p>
<p><strong>在CentOS机器的命令行输入以下命令，即可创建一个spark_shell：</strong></p>
<pre><code class="language-bash">sudo docker exec -it master spark-shell --executor-memory 512M --total-executor-cores 2
</code></pre>
<h5 id="3spark">3、spark集群开机自启动</h5>
<p>spark集群和hdfs集群由多个容器各司其职来完成整个工作的，每个容器启动有顺序要求，官方通过 docker-compose.yml 文件对容器进行编排，使用 depends_on 定义依赖关系决定了容器的启动顺序。常规来说，正常使用 docker-compose 来启动容器不会存在任何问题，各个容器服务都能正常启动并运行。</p>
<p>我们上面配置的docker-compose.yml文件中并没有给容器配置开机自启（restart: always）</p>
<p>但是…</p>
<p>如果你在docker-compose.yml 中为所有容器都配置了 restart: always
这表示所有的容器在意外关闭后都会自动重启，比如 docker 重启或服务器重启。</p>
<p>然而…</p>
<p>docker 本身对容器的启动是不区分顺序的，也就是你可以认为 depends_on 是 docker-compose 独有的功能。当我们服务器重启后，docker 会将设定 restart: always 的容器启动（不分先后顺序）。而我们实际的业务需要又会因为启动顺序问题导致一些容器启动失败，这样就出现了我们的集群在服务器重启后可能出现部分容器启动失败的问题。</p>
<p>那么，如何解决这个问题呢？</p>
<p>写一个系统服务（将 spark和hdfs集群 配置为 systemd 的 service），将 docker-compose up -d 纳入启动命令中，将 docker-compose stop纳入停止命令中，这样将服务配置为随系统启动即可。</p>
<h6 id="31">3.1、自定义系统服务</h6>
<p>进入到/usr/lib/systemd/system/目录，并编辑一个spark和hdfs集群的服务配置文件（这里我把文件命名为：sparkcluster_hdfs.service）:</p>
<pre><code class="language-bash">cd /usr/lib/systemd/system/
sudo vi sparkcluster_hdfs.service
</code></pre>
<p>添加以下内容：</p>
<pre><code>[Unit]
Description=sparkcluster_hdfs
After=docker.service systemd-networkd.service systemd-resolved.service
Requires=docker.service
Documentation=https://www.baidu.com/

[Service]
Type=simple
Restart=always
RestartSec=5
PrivateTmp=true
ExecStart=/usr/local/bin/docker-compose -f /home/sparkcluster_hdfs/docker-compose.yml up
ExecReload=/usr/local/bin/docker-compose -f /home/sparkcluster_hdfs/docker-compose.yml restart
ExecStop=/usr/local/bin/docker-compose -f /home/sparkcluster_hdfs/docker-compose.yml stop

[Install]
WantedBy=multi-user.target
</code></pre>
<p>这里面的路径只能是绝对路径！！！
docker-compose 的绝对路径，可以通过命令 which docker-compose 查看。</p>
<h6 id="32">3.2、设置服务为随系统自启</h6>
<p>设置开机自启</p>
<pre><code class="language-bash">sudo systemctl enable sparkcluster_hdfs
</code></pre>
<p>启动服务</p>
<pre><code class="language-bash">sudo systemctl start sparkcluster_hdfs
</code></pre>
<p>最后，重启你的服务器验证一下结果。</p>
<h4 id="v2ray-core">v2ray-core</h4>
<h4 id="nginx-proxy-manager">nginx-proxy-manager</h4>
<pre><code class="language-bash">sudo docker pull jc21/nginx-proxy-manager:2.12.2
sudo docker pull zoeyvid/nginx-proxy-manager:341

sudo docker pull chishin/nginx-proxy-manager-zh:2.12.2

sudo docker pull zoeyvid/npmplus:434
#https://hub.docker.com/r/zoeyvid/npmplus#quick-setup
</code></pre>
<p>docker-compose方式：</p>
<pre><code>version: '3'
services:
  app:
    image: 'jc21/nginx-proxy-manager:latest'
    restart: unless-stopped
    ports:
      - '80:80'
      - '81:81'
      - '443:443'
    volumes:
      - ./data:/data
      - ./letsencrypt:/etc/letsencrypt
</code></pre>
<pre><code>docker-compose up -d

#如果使用的是 docker-compose-plugin
docker compose up -d
</code></pre>
<h4 id="openvpn">openvpn</h4>
<h5 id="1_1">教程1：</h5>
<ul>
<li>镜像：https://hub.docker.com/r/kylemanna/openvpn</li>
</ul>
<pre><code class="language-bash">docker pull kylemanna/openvpn:latest
# 创建缩主机目录
mkdir openvpn
</code></pre>
<ul>
<li>docker-compose.yml</li>
</ul>
<pre><code class="language-bash">services:
  openvpn:
    image: kylemanna/openvpn:latest
    container_name: openvpn
    volumes:
      - /etc/localtime:/etc/localtime
      - ./openvpn:/etc/openvpn
    ports:
      - '1194:1194/udp'
    cap_add:
      - NET_ADMIN
    restart: always
    privileged: true
</code></pre>
<ul>
<li>公网 IP</li>
</ul>
<pre><code class="language-bash"># 查询服务器公网 IP 地址
curl ifconfig.me 
</code></pre>
<ul>
<li>公网 IP 是一个唯一标识你的服务器的地址。当客户端想要连接到 OpenVPN 服务器时，它们需要知道服务器的公网 IP 才能建立连接。</li>
<li>路由器和防火墙通过公网 IP 来将传入的 OpenVPN 流量路由到正确的服务器。</li>
</ul>
<p><strong>使用方法</strong></p>
<p><strong>生成配置文件</strong></p>
<pre><code class="language-bash"># 生成 OpenVPN 配置文件，使用 UDP 协议和指定的服务器 IP 地址
docker-compose run --rm openvpn ovpn_genconfig -u udp://公网IP
</code></pre>
<p><strong>初始化 PKI</strong></p>
<pre><code class="language-bash"># 初始化 Public Key Infrastructure (PKI)，也就是生成和管理证书、密钥
docker-compose run --rm openvpn ovpn_initpki
# 输入新的 CA 密钥
# Common Name (eg: your user, host, or server name) [Easy-RSA CA]
</code></pre>
<p><strong>生成客户端证书</strong></p>
<pre><code class="language-bash"># 生成客户端证书，而且这个证书是无需密码的
docker-compose run --rm openvpn easyrsa build-client-full client1 nopass

# 或：生成客户端证书，而且这个证书是有密码的
docker-compose run --rm openvpn easyrsa build-client-full client2
</code></pre>
<ul>
<li>新生成的客户端证书密钥文件在 ./openvpn/pki/private 目录下</li>
</ul>
<pre><code class="language-bash"># 导出已生成的客户端配置文件（.ovpn 文件）
docker-compose run --rm openvpn ovpn_getclient client1 &gt; ./client1.ovpn
</code></pre>
<p>启动 VPN 服务</p>
<pre><code class="language-bash"># 启动 openvpn 服务
docker-compose up -d openvp
</code></pre>
<p>载你系统对应的客户端并安装运行后，在你的任务栏右下角中可看到小电脑类似的图标，右键后在出来的导入配置文件选项中，将先前导出的客户端配置文件client1.ovpn文件 </p>
<p><strong>撤销客户端证书</strong></p>
<pre><code class="language-bash"># 撤销客户端证书
docker-compose run --rm openvpn easyrsa revoke client1
</code></pre>
<pre><code class="language-bash"># 生成证书撤销列表（CRL），并且额外指示 EasyRSA 更新相关数据库或索引
docker-compose run *--rm openvpn easyrsa gen-crl update-db*
</code></pre>
<pre><code class="language-bash"># 重启 openvpn 服务
docker-compose up -d openvpn
</code></pre>
<p><strong>Docker容器内部的命令执行</strong></p>
<pre><code class="language-bash"># 创建client1用户，有两次密码输入
easyrsa build-client-full client1

# 导出证书
cd /etc/openvpn/pki/private/ &amp;&amp; ovpn_getclient client1 &gt; ./client1.ovpn

#注销client1用户，注意，注销完后同样需要重启容器
easyrsa revoke client1
</code></pre>
<p><strong>常见问题</strong></p>
<p>1、在连接时提示：server pushed compression settings that are not allowed and will result in a non-working connection. See also allow-compression in the manual.</p>
<p>解决方案：在你的Open<a href="https://so.csdn.net/so/search?q=VPN配置&amp;spm=1001.2101.3001.7020">VPN配置</a>文件中添加或修改以下行  </p>
<pre><code class="language-bash">allow-compression yes
</code></pre>
<h5 id="2_1">教程2：</h5>
<p><strong>Docker 部署</strong></p>
<ul>
<li>镜像：https://hub.docker.com/r/kylemanna/openvpn</li>
</ul>
<pre><code class="language-bash">docker pull kylemanna/openvpn:latest
# 创建缩主机目录
mkdir openvpn
</code></pre>
<ul>
<li>docker-compose.yml</li>
</ul>
<pre><code class="language-yml">services:
  openvpn:
    image: kylemanna/openvpn:latest
    container_name: openvpn
    volumes:
      - /etc/localtime:/etc/localtime
      - ./openvpn:/etc/openvpn
    ports:
      - '1194:1194/udp'
    cap_add:
      - NET_ADMIN
    restart: always
    privileged: true
</code></pre>
<p><strong>公网 IP</strong></p>
<pre><code class="language-bash"># 查询服务器公网 IP 地址
curl ifconfig.me
</code></pre>
<ul>
<li>公网 IP 是一个唯一标识你的服务器的地址。当客户端想要连接到 OpenVPN 服务器时，它们需要知道服务器的公网 IP 才能建立连接。</li>
<li>路由器和防火墙通过公网 IP 来将传入的 OpenVPN 流量路由到正确的服务器。</li>
</ul>
<p><strong>使用方法</strong></p>
<p><strong>生成配置文件</strong></p>
<pre><code class="language-bash"># 生成 OpenVPN 配置文件，使用 UDP 协议和指定的服务器 IP 地址
docker-compose run --rm openvpn ovpn_genconfig -u udp://公网IP
</code></pre>
<ul>
<li>在 ./openvpn 目录下生成配置文件</li>
</ul>
<p><strong>初始化 PKI</strong></p>
<pre><code class="language-bash"># 初始化 Public Key Infrastructure (PKI)，也就是生成和管理证书、密钥
docker-compose run --rm openvpn ovpn_initpki
# 输入新的 CA 密钥
# Common Name (eg: your user, host, or server name) [Easy-RSA CA]
</code></pre>
<ul>
<li>在 ./openvpn 目录下新生成 pki 目录</li>
</ul>
<p><strong>生成客户端证书</strong></p>
<pre><code class="language-bash"># 生成客户端证书，而且这个证书是无需密码的
docker-compose run --rm openvpn easyrsa build-client-full client1 nopass
# 或：生成客户端证书，而且这个证书是有密码的
docker-compose run --rm openvpn easyrsa build-client-full client2
</code></pre>
<ul>
<li>新生成的客户端证书密钥文件在 ./openvpn/pki/private 目录下</li>
</ul>
<pre><code class="language-bash"># 导出已生成的客户端配置文件（.ovpn 文件）
docker-compose run --rm openvpn ovpn_getclient client1 &gt; ./client1.ovpn
</code></pre>
<ul>
<li>client1.ovpn 文件</li>
</ul>
<p><strong>启动 VPN 服务</strong></p>
<pre><code class="language-bash"># 启动 openvpn 服务
docker-compose up -d openvpn
</code></pre>
<p><strong>OpenVPN 客户端</strong></p>
<p><strong>撤销客户端证书</strong></p>
<pre><code class="language-bash"># 撤销客户端证书
docker-compose run --rm openvpn easyrsa revoke client1
</code></pre>
<ul>
<li>并且 ./openvpn/pki/private 目录下的 client1.key 文件也已被删除</li>
</ul>
<pre><code class="language-bash"># 生成证书撤销列表（CRL），并且额外指示 EasyRSA 更新相关数据库或索引
docker-compose run --rm openvpn easyrsa gen-crl update-db
</code></pre>
<pre><code class="language-bash"># 重启 openvpn 服务
docker restart openvpn
</code></pre>
<blockquote>
<p><strong>注意：</strong> 完成 openvpn 服务重启后，客户端证书才算真正完成撤销。</p>
</blockquote>
<h4 id="openvpn-as">××openvpn-as</h4>
<h5 id="zh-cn">zh-cn:</h5>
<p>拉取镜像：</p>
<pre><code class="language-bash">sudo docker pull openvpn/openvpn-as:2.14.1-ff013d4d-Ubuntu22
</code></pre>
<p>运行：</p>
<p>创建数据文件夹：</p>
<pre><code class="language-bash">sudo mkdir -p /home/ubuntu/docker/openvpn-as-default/openvpn
</code></pre>
<p>基于 Access Server 镜像并使用以下参数运行 Docker 容器：</p>
<pre><code class="language-bash">sudo docker run -itd --name=openvpn-as-default --restart=always --device /dev/net/tun --cap-add=MKNOD --cap-add=NET_ADMIN -p 943:943 -p 443:443 -p 1194:1194/udp -v /home/ubuntu/docker/openvpn-as-default/openvpn:/openvpn openvpn/openvpn-as:2.14.1-ff013d4d-Ubuntu22

#sudo docker run -itd --name=openvpn-as-default --restart=always --device /dev/net/tun --cap-add=MKNOD --cap-add=NET_ADMIN -p 40943:943 -p 40443:443 -p 41194:1194/udp -v /home/ubuntu/docker/openvpn-as-default/openvpn:/openvpn openvpn/openvpn-as:2.14.1-ff013d4d-Ubuntu22

</code></pre>
<table>
<thead>
<tr>
<th><a href="https://openvpn.net/as-docs/docker.html#UUID-d7e3eb1d-7337-ddfd-c84c-2ce341b3e7e3_run-co1"><strong>1</strong></a></th>
<th>为 VPN 流量提供对 TUN 设备的访问。</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://openvpn.net/as-docs/docker.html#UUID-d7e3eb1d-7337-ddfd-c84c-2ce341b3e7e3_run-co2"><strong>2</strong></a></td>
<td>允许容器创建设备节点。</td>
</tr>
<tr>
<td><a href="https://openvpn.net/as-docs/docker.html#UUID-d7e3eb1d-7337-ddfd-c84c-2ce341b3e7e3_run-co3"><strong>3</strong></a></td>
<td>授予容器必要的网络管理权限。</td>
</tr>
<tr>
<td><a href="https://openvpn.net/as-docs/docker.html#UUID-d7e3eb1d-7337-ddfd-c84c-2ce341b3e7e3_run-co4"><strong>4</strong></a></td>
<td>打开必要的端口：943 用于管理 Web UI，443 用于 TCP，1194 用于 UDP。</td>
</tr>
<tr>
<td><a href="https://openvpn.net/as-docs/docker.html#UUID-d7e3eb1d-7337-ddfd-c84c-2ce341b3e7e3_run-co5"><strong>5</strong></a></td>
<td>存储 Access Server 配置文件的位置。将 <strong><em>*<path to date>*</em></strong> 替换为您首选的文件路径。</td>
</tr>
</tbody>
</table>
<p>登录到管理 Web UI：</p>
<p>您已经安装了 Access Server，并且容器正在运行。现在，您可以登录到管理 Web UI，这是一个用于管理 VPN 服务器的基于 Web 的图形界面，无需 Linux 知识也能使用。</p>
<p>管理 Web UI 可通过 <code>https://DOCKER-HOST-IP:943/admin</code> 访问。</p>
<p>查找临时密码</p>
<p>默认用户是 <strong><em>*openvpn*</em></strong>，您可以在容器日志中找到与初始 Access Server 配置一起创建的临时密码：</p>
<ol>
<li>在容器运行时，使用以下命令显示日志：</li>
</ol>
<p><code>bash
   sudo docker logs -f openvpn-as</code></p>
<ul>
<li>
<p>显示 Access Server 初始配置工具的输出。</p>
</li>
<li>
<p>滚动查找行，<strong><em>*Auto-generated pass = "<password>". Setting in db...*</em></strong></p>
</li>
<li>
<p>使用生成的密码和 <strong><em>*openvpn*</em></strong> 用户名登录管理 Web UI。</p>
</li>
</ul>
<p>以管理员身份登录</p>
<p>要访问并登录到管理 Web UI：</p>
<ol>
<li>
<p>打开一个 Web 浏览器。</p>
</li>
<li>
<p>输入管理 Web UI URL，格式为 <strong><em>*https://DOCKER-HOST-IP:943/admin*</em></strong>。</p>
</li>
<li>
<p>会显示安全警告。Access Server 使用自签名 SSL 证书。我们建议您将其替换为签名证书。请参阅 <a href="https://openvpn.net/as-docs/ssl-certificates.html">SSL 证书</a>。</p>
</li>
</ol>
<p>### 重要</p>
<p>确保在 URL 中使用 <strong><em>*https*</em></strong>。</p>
<ol>
<li>
<p>点击通过安全警告。</p>
</li>
<li>
<p>显示 <strong><em>*管理员登录*</em></strong> 页面。</p>
</li>
<li>
<p>输入 <strong><em>*openvpn*</em></strong> 用户名和临时密码，然后点击 <strong><em>*登录*</em></strong>。</p>
</li>
<li>
<p>显示 EULA，供您阅读、接受并继续到管理员 Web UI 配置页面。</p>
</li>
</ol>
<p>更新 IP 地址/主机名</p>
<p>为了使您的设备能够正确连接到 VPN 服务器，您需要更新域名或公网 IP 地址：</p>
<ol>
<li>
<p>登录到管理 Web UI。</p>
</li>
<li>
<p>点击 <strong><em>*配置 &gt; 网络设置*</em></strong>。</p>
</li>
<li>
<p>将 <strong><em>*主机名或 IP 地址*</em></strong> 字段更改为公网 IP 地址或您的域名。</p>
</li>
</ol>
<p>### 注意</p>
<p>Access Server 可能会在此字段中填充一个私有 IP 地址。客户端需要公网 IP 来从外部网络访问，或者是映射了 A 记录的域名。我们建议使用 <a href="https://openvpn.net/as-docs/hostname.html">域名</a>。</p>
<ol>
<li>点击 <strong><em>*保存设置*</em></strong> 并点击 <strong><em>*更新正在运行的服务器*</em></strong>。</li>
</ol>
<p>限制和已知问题</p>
<p>以下是从 Docker 镜像部署 Access Server 时的已知问题或限制：</p>
<ul>
<li><strong><em>*故障转移模式：*</em></strong> 不支持此功能。</li>
<li><strong><em>*第 2 层（桥接）：*</em></strong> 不支持此模式。</li>
<li><strong><em>*固定许可证密钥：*</em></strong> 不支持此许可证密钥模型。使用固定密钥可能会导致许可证失效，因为硬件规格指纹不是持久性的。</li>
<li><strong><em>*DCO：*</em></strong> 如果您在主机 Linux 系统上安装并加载 DCO，则可以启用 DCO。</li>
<li><strong><em>*集群：*</em></strong> 您可以使用从 Docker 镜像部署的 Access Server 构建集群功能，具有以下限制：</li>
<li>必须暴露端口 TCP945 用于节点间通信。</li>
<li>每个主机系统一次只能运行一个集群节点。</li>
<li>主机必须能够直接通过互联网访问，而不是通过负载均衡器、代理或入口控制器。</li>
<li><strong><em>*性能：*</em></strong> 额外的抽象层可能导致性能下降并增加延迟。我们不建议使用 Docker 部署高负载的安装。</li>
<li><strong><em>*PAM 认证方法：*</em></strong> 我们建议避免使用 PAM 作为认证方法，因为存储在容器中的用户凭证不是持久性的。</li>
<li><strong><em>*日志：*</em></strong> Access Server 会将日志转发到 Docker，因此它不能在 Access Server 配置中处理日志记录。请参阅 Docker 日志文档以设置日志轮换、转发等。</li>
<li><strong><em>*IPv6：*</em></strong> 如果您计划为 VPN 客户端使用 IPv6，我们不建议将 Access Server 部署在 Docker 容器中，因为 Docker 网络工具集对 IPv6 的支持是有限的/实验性的。</li>
</ul>
<h5 id="en">en:</h5>
<p>Pull the image:</p>
<pre><code class="language-bash">sudo docker pull openvpn/openvpn-as
</code></pre>
<p>Run:</p>
<p>Create data folder:</p>
<pre><code class="language-bash">sudo mkdir -p /home/ubuntu/docker/openvpn-as-default
</code></pre>
<p>Run the Docker container based on the Access Server image with these parameters:</p>
<pre><code class="language-bash">sudo docker run -itd --name=openvpn-as-default --device /dev/net/tun --cap-add=MKNOD --cap-add=NET_ADMIN -p 40943:943 -p 40443:443 -p 41194:1194/udp -v /home/ubuntu/docker/openvpn-as-default:/openvpn openvpn/openvpn-as
</code></pre>
<table>
<thead>
<tr>
<th><a href="https://openvpn.net/as-docs/docker.html#UUID-d7e3eb1d-7337-ddfd-c84c-2ce341b3e7e3_run-co1"><strong>1</strong></a></th>
<th>Provides access to the TUN device for VPN traffic.</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://openvpn.net/as-docs/docker.html#UUID-d7e3eb1d-7337-ddfd-c84c-2ce341b3e7e3_run-co2"><strong>2</strong></a></td>
<td>Allows the container to create device nodes.</td>
</tr>
<tr>
<td><a href="https://openvpn.net/as-docs/docker.html#UUID-d7e3eb1d-7337-ddfd-c84c-2ce341b3e7e3_run-co3"><strong>3</strong></a></td>
<td>Grants the container the necessary network administration capabilities.</td>
</tr>
<tr>
<td><a href="https://openvpn.net/as-docs/docker.html#UUID-d7e3eb1d-7337-ddfd-c84c-2ce341b3e7e3_run-co4"><strong>4</strong></a></td>
<td>Opens up the necessary ports: 943 for the Admin Web UI, 443 for TCP, and 1194 for UDP.</td>
</tr>
<tr>
<td><a href="https://openvpn.net/as-docs/docker.html#UUID-d7e3eb1d-7337-ddfd-c84c-2ce341b3e7e3_run-co5"><strong>5</strong></a></td>
<td>Location for storing the Access Server configuration files. Replace <strong><em>*<path to date>*</em></strong> with your preferred file path.</td>
</tr>
</tbody>
</table>
<p>Sign in to the Admin Web UI:</p>
<p>You've installed Access Server, and the container is running. You can now sign in to the Admin Web UI, a web-based GUI for managing your VPN server, with or without Linux knowledge.</p>
<p>The Admin Web UI is available at <code>https://DOCKER-HOST-IP:943/admin</code>.</p>
<p>Find the temporary password</p>
<p>The default user is <strong><em>*openvpn*</em></strong> and you can find the temporary password created with the initial Access Server configuration in the container logs:</p>
<ol>
<li>With the container running, display the logs with this command:</li>
</ol>
<p><code>bash
   sudo docker logs -f openvpn-as</code></p>
<ul>
<li>
<p>The Access Server Initial Configuration Tool output displays.</p>
</li>
<li>
<p>Scroll to find the line, <strong><em>*Auto-generated pass = "<password>". Setting in db...*</em></strong></p>
</li>
<li>
<p>Use the generated password with the <strong><em>*openvpn*</em></strong> username to sign in to the Admin Web UI.</p>
</li>
</ul>
<p>Sign in as an administrator</p>
<p>To access and sign in to the Admin Web UI:</p>
<ol>
<li>
<p>Open a web browser.</p>
</li>
<li>
<p>Enter the Admin Web UI URL, available at <strong><em>*https://DOCKER-HOST-IP:943/admin*</em></strong>.</p>
</li>
<li>
<p>A security warning displays. Access Server uses a self-signed SSL certificate. We recommend replacing it with a signed certificate. Refer to <a href="https://openvpn.net/as-docs/ssl-certificates.html">SSL Certificates</a>.</p>
</li>
</ol>
<p>### Important</p>
<p>Ensure you use <strong><em>*https*</em></strong> in the URL.</p>
<ol>
<li>
<p>Click through the security warning.</p>
</li>
<li>
<p>The <strong><em>*Admin Login*</em></strong> displays.</p>
</li>
<li>
<p>Enter the <strong><em>*openvpn*</em></strong> username with the temporary password and click <strong><em>*Sign In*</em></strong>.</p>
</li>
<li>
<p>The EULA displays for you to read through, accept, and proceed to the Admin Web UI configuration pages.</p>
</li>
</ol>
<p>Update the IP address/hostname</p>
<p>For your devices to properly connect to your VPN server, you need to update the domain or public IP address:</p>
<ol>
<li>
<p>Sign in to the Admin Web UI.</p>
</li>
<li>
<p>Click <strong><em>*Configuration &gt; Network Settings*</em></strong>.</p>
</li>
<li>
<p>Change the <strong><em>*Hostname or IP Address*</em></strong> field to a public IP address or your domain name.</p>
</li>
</ol>
<p>### Note</p>
<p>Access Server likely has a private IP address populated in this field. Clients need a public IP to access from outside the network, or a domain name mapped with an A record. We recommend using a <a href="https://openvpn.net/as-docs/hostname.html">domain name</a>.</p>
<ol>
<li>Click <strong><em>*Save Settings*</em></strong> and <strong><em>*Update Running Server*</em></strong>.</li>
</ol>
<p>Limitations and known issues</p>
<p>The following are known issues or limitations if you deploy Access Server from a Docker image:</p>
<ul>
<li><strong><em>*Failover mode:*</em></strong> This feature isn't supported.</li>
<li><strong><em>*Layer 2 (bridging):*</em></strong> This mode isn't supported.</li>
<li><strong><em>*Fixed license keys:*</em></strong> This license key model isn't supported. Using fixed keys can cause license invalidation because the hardware specification fingerprint isn't persistent.</li>
<li><strong><em>*DCO:*</em></strong> You can enable DCO with Access Server if you install and load it on the host Linux system.</li>
<li><strong><em>*Clustering:*</em></strong> You can use Access Servers, deployed from Docker images, to build cluster functionality with the following limitations:</li>
<li>You must expose port TCP945 for internode communication.</li>
<li>You can only run one cluster node per Host system at a time.</li>
<li>Hosts must be available directly from the internet, not via a load balancer, proxy, or ingress controller.</li>
<li><strong><em>*Performance:*</em></strong> The additional abstraction layer can cause performance degradation and increase latency. We don't recommend deploying highly loaded installations using Docker.</li>
<li><strong><em>*PAM authentication method:*</em></strong> We recommend avoiding PAM as your authentication method because user credentials stored inside the container aren't persistent.</li>
<li><strong><em>*Logs:*</em></strong> Access Server forwards logs to Docker, so it can't handle logging in the Access Server configuration. See the Docker logging documentation to set up rotation, forwarding, etc.</li>
<li><strong><em>*IPv6:*</em></strong> We don't recommend Access Server inside a Docker container if you plan to use IPv6 for VPN clients because IPv6 support in the Docker network toolset is limited/experimental.</li>
</ul>
<h4 id="qbittorrent">qbittorrent</h4>
<p>linuxserver/qbittorrent</p>
<pre><code class="language-bash">sudo docker pull linuxserver/qbittorrent:amd64-5.0.3-libtorrentv1
</code></pre>
<pre><code class="language-bash">sudo mkdir -p /mnt/sda1/docker/qbittorrent-default/appdata
sudo mkdir -p /mnt/sda1/docker/qbittorrent-default/downloads
</code></pre>
<p>docker-compose</p>
<pre><code class="language-yaml">---
services:
  qbittorrent:
    image: linuxserver/qbittorrent:amd64-5.0.3-libtorrentv1
    container_name: qbittorrent
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Etc/UTC
      - WEBUI_PORT=8080
      - TORRENTING_PORT=6881
    volumes:
      - /mnt/sda1/docker/qbittorrent-default/appdata:/config
      - /mnt/sda1/docker/qbittorrent-default/downloads:/downloads #optional
    ports:
      - 8080:8080
      - 6881:6881
      - 6881:6881/udp
    restart: unless-stopped

</code></pre>
<p>docker-cli:</p>
<p>这里映射55555端口用于传输。</p>
<pre><code class="language-bash">sudo docker run -itd --name=qbittorrent-default -e PUID=1000 -e PGID=1000 -e TZ=Etc/UTC -e WEBUI_PORT=48238 -e TORRENTING_PORT=46881 -p 48238:48238 -p 46881:46881 -p 46881:46881/udp -p 55555:55555 -v /mnt/sda1/docker/qbittorrent-default/appdata:/config -v /mnt/sda1/docker/qbittorrent-default/downloads:/downloads --restart unless-stopped linuxserver/qbittorrent:amd64-5.0.3-libtorrentv1
</code></pre>
<p><strong>Parameters</strong></p>
<p>Containers are configured using parameters passed at runtime (such as those above). These parameters are separated by a colon and indicate <code>&lt;external&gt;:&lt;internal&gt;</code> respectively. For example, <code>-p 8080:80</code> would expose port <code>80</code> from inside the container to be accessible from the host's IP on port <code>8080</code> outside the container.</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Parameter</th>
<th style="text-align: left;">Function</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><code>-p 8080:8080</code></td>
<td style="text-align: left;">WebUI</td>
</tr>
<tr>
<td style="text-align: center;"><code>-p 6881:6881</code></td>
<td style="text-align: left;">tcp connection port</td>
</tr>
<tr>
<td style="text-align: center;"><code>-p 6881:6881/udp</code></td>
<td style="text-align: left;">udp connection port</td>
</tr>
<tr>
<td style="text-align: center;"><code>-e PUID=1000</code></td>
<td style="text-align: left;">for UserID - see below for explanation</td>
</tr>
<tr>
<td style="text-align: center;"><code>-e PGID=1000</code></td>
<td style="text-align: left;">for GroupID - see below for explanation</td>
</tr>
<tr>
<td style="text-align: center;"><code>-e TZ=Etc/UTC</code></td>
<td style="text-align: left;">specify a timezone to use, see this <a href="https://en.wikipedia.org/wiki/List_of_tz_database_time_zones#List">list⁠</a>.</td>
</tr>
<tr>
<td style="text-align: center;"><code>-e WEBUI_PORT=8080</code></td>
<td style="text-align: left;">for changing the port of the web UI, see below for explanation</td>
</tr>
<tr>
<td style="text-align: center;"><code>-e TORRENTING_PORT=6881</code></td>
<td style="text-align: left;">for changing the port of tcp/udp connection, see below for explanation</td>
</tr>
<tr>
<td style="text-align: center;"><code>-v /config</code></td>
<td style="text-align: left;">Contains all relevant configuration files.</td>
</tr>
<tr>
<td style="text-align: center;"><code>-v /downloads</code></td>
<td style="text-align: left;">Location of downloads on disk.</td>
</tr>
<tr>
<td style="text-align: center;"><code>--read-only=true</code></td>
<td style="text-align: left;">Run container with a read-only filesystem. Please <a href="https://docs.linuxserver.io/misc/read-only/">read the docs⁠</a>.</td>
</tr>
<tr>
<td style="text-align: center;"><code>--user=1000:1000</code></td>
<td style="text-align: left;">Run container with a non-root user. Please <a href="https://docs.linuxserver.io/misc/non-root/">read the docs⁠</a>.</td>
</tr>
</tbody>
</table>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.3220b9d7.min.js"></script>
      
    
  </body>
</html>